{"version":3,"file":"belter.min.js","mappings":"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","sources":["webpack://belter/webpack/universalModuleDefinition","webpack://belter/webpack/bootstrap","webpack://belter/webpack/runtime/define property getters","webpack://belter/webpack/runtime/hasOwnProperty shorthand","webpack://belter/webpack/runtime/make namespace object","webpack://belter/./src/screenHeights.js","webpack://belter/./src/device.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://belter/./node_modules/@krakenjs/zalgo-promise/src/utils.js","webpack://belter/./node_modules/@krakenjs/zalgo-promise/src/exceptions.js","webpack://belter/./node_modules/@krakenjs/zalgo-promise/src/flush.js","webpack://belter/./node_modules/@krakenjs/zalgo-promise/src/promise.js","webpack://belter/./node_modules/@krakenjs/cross-domain-utils/src/constants.js","webpack://belter/./node_modules/@krakenjs/cross-domain-utils/src/utils.js","webpack://belter/./node_modules/@krakenjs/cross-domain-safe-weakmap/src/util.js","webpack://belter/./node_modules/@krakenjs/cross-domain-safe-weakmap/src/weakmap.js","webpack://belter/./src/util.js","webpack://belter/./node_modules/@krakenjs/cross-domain-safe-weakmap/src/native.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://belter/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://belter/./src/constants.js","webpack://belter/./src/dom.js","webpack://belter/./src/storage.js","webpack://belter/./src/experiment.js","webpack://belter/./src/global.js","webpack://belter/./src/http.js","webpack://belter/./src/types.js","webpack://belter/./src/decorators.js","webpack://belter/./src/css.js","webpack://belter/./src/test.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"belter\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"belter\"] = factory();\n\telse\n\t\troot[\"belter\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* @flow */\n\nexport const sfvcScreens = {\n  /*\n   * iPhone 14 Pro Max\n   */\n  \"932\": {\n    textSizeHeights: [746, 742, 738], // 732 removed as same in Safari\n    textSizeHeightsNoTabs: [854, 852, 850, 848],\n    zoomHeight: {\n      \"1.15\": [746, 742, 738], // 733 removed as same in Safari\n      \"1.25\": [746, 743], // 738, 733 removed as same in Safari\n      \"1.5\": [746, 743], // 738, 732 removed as same in Safari\n      \"1.75\": [746, 742, 739], // 732 removed as same in Safari\n      \"2\": [746, 742], // 738, 732 removed as same in Safari\n      \"2.5\": [745, 743], // 738, 733 removed as same in Safari\n      \"3\": [749], // 743, 740, 734 removed as same in Safari\n      \"3.01\": [749], // 743, 740, 734 removed as same in Safari\n    },\n    maybeSafari: {\n      \"1\": [732],\n      \"1.15\": [733],\n      \"1.25\": [738, 733],\n      \"1.5\": [738, 732],\n      \"1.75\": [732],\n      \"2\": [738, 732],\n      \"2.5\": [738, 733],\n      \"3\": [743, 740, 734],\n      \"3.01\": [743, 740, 734],\n    },\n  },\n\n  /*\n   * iPhone 12 Pro Max\n   * iPhone 13 Pro Max\n   * iPhone 14 Plus\n   */\n  \"926\": {\n    textSizeHeights: [752, 748, 744, 738],\n    textSizeHeightsNoTabs: [860, 858, 856, 854],\n    zoomHeight: {\n      \"1.15\": [752, 747, 744, 738],\n      \"1.25\": [753, 748, 744, 738],\n      \"1.5\": [752, 749, 744, 738],\n      \"1.75\": [753, 747, 744, 739],\n      \"2\": [752, 748, 744], // 738 removed as same in Safari\n      \"2.5\": [753, 748], // 745, 738 removed as same in Safari\n      \"3\": [753, 744], // 747, 738 removed as same in Safari\n    },\n    maybeSafari: {\n      \"2\": [738],\n      \"2.5\": [745, 738],\n      \"3\": [747, 738],\n    },\n  },\n\n  /*\n   * iPhone XS Max\n   * iPhone 11 Pro Max\n   * iPhone XR\n   * iPhone 11\n   */\n  \"896\": {\n    textSizeHeights: [721, 717, 713, 707],\n    textSizeHeightsNoTabs: [829, 827, 825, 823],\n    zoomHeight: {\n      \"1.15\": [721, 716, 713, 707],\n      \"1.25\": [721, 718, 713, 708],\n      \"1.5\": [722, 717, 713], // 707 removed as same in Safari\n      \"1.75\": [721, 718, 712, 707],\n      \"2\": [722, 718, 714, 708],\n      \"2.5\": [720, 718, 713, 708],\n      \"3\": [720, 717, 708], // 714 removed as same in Safari\n    },\n    maybeSafari: {\n      \"1.5\": [707],\n      \"3\": [714],\n    },\n  },\n\n  /*\n   * iPhone 14 Pro\n   */\n  \"852\": {\n    textSizeHeights: [666, 662, 658], // 652 removed as same in Safari\n    textSizeHeightsNoTabs: [774, 772, 770, 768],\n    zoomHeight: {\n      \"1.15\": [666, 662, 658], // 652 removed as same in Safari\n      \"1.25\": [665, 661, 658], // 651 removed as same in Safari\n      \"1.5\": [666, 662, 659], // 653 removed as same in Safari\n      \"1.75\": [667, 662], // 658, 653 removed as same in Safari\n      \"1.99\": [663, 659], // 655, 649 removed as same in Safari\n      \"2\": [663, 659], // 655, 649 removed as same in Safari\n      \"2.5\": [665, 663], // 658, 653 removed as same in Safari\n      \"3\": [666, 663], // 657, 651 removed as same in Safari\n    },\n    maybeSafari: {\n      \"1\": [652],\n      \"1.15\": [652],\n      \"1.25\": [651],\n      \"1.5\": [653],\n      \"1.75\": [658, 653],\n      \"1.99\": [655, 649],\n      \"2\": [655, 649],\n      \"2.5\": [658, 653],\n      \"3\": [657, 651],\n    },\n  },\n\n  /*\n   * iPhone 12\n   * iPhone 12 Pro\n   * iPhone 13\n   * iPhone 14\n   */\n  \"844\": {\n    textSizeHeights: [670, 666, 662, 656],\n    textSizeHeightsNoTabs: [778, 776, 774, 772],\n    zoomHeight: {\n      \"1.15\": [670, 666, 662], // 656 removed as same in Safari\n      \"1.25\": [670, 666, 663, 656],\n      \"1.5\": [671, 666, 662], // 656 removed as same in Safari\n      \"1.75\": [670, 667, 662, 656],\n      \"2\": [670, 666, 662], // 656 removed as same in Safari\n      \"2.5\": [670, 663], // 665, 655 removed as same in Safari\n      \"3\": [669, 666, 663, 657], // 663 removed as same in Safari\n    },\n    maybeSafari: {\n      \"1.15\": [656],\n      \"1.5\": [656],\n      \"2\": [656],\n      \"2.5\": [665, 655],\n      \"3\": [663],\n    },\n  },\n\n  /*\n   * iPhone X\n   * iPhone XS\n   * iPhone 11 Pro\n   * iPhone 12 Mini\n   */\n  \"812\": {\n    textSizeHeights: [641, 637, 633, 627],\n    textSizeHeightsNoTabs: [749, 747, 745, 743],\n    zoomHeight: {\n      \"1.15\": [641, 637, 633, 627],\n      \"1.25\": [641, 638, 633, 628],\n      \"1.5\": [641, 638, 633, 627],\n      \"1.75\": [641, 637, 634], // 627 removed as same in Safari\n      \"2\": [642, 638, 634, 628],\n      \"2.5\": [640, 638, 633, 628],\n      \"3\": [642, 633], // 636, 627 removed as same in Safari\n    },\n    maybeSafari: {\n      \"1.75\": [627],\n      \"3\": [636, 627],\n    },\n  },\n\n  /*\n   * iPhone 6 Plus\n   * iPhone 6S Plus\n   * iPhone 7 Plus\n   * iPhone 8 Plus\n   */\n  \"736\": {\n    textSizeHeights: [628, 624, 620, 614],\n    textSizeHeightsNoTabs: [736, 734, 732, 730],\n    zoomHeight: {\n      \"1.15\": [628, 624, 620, 614],\n      \"1.25\": [628, 624, 620, 614],\n      \"1.5\": [629, 624, 620], // 614\n      \"1.75\": [628, 625, 620, 614],\n      \"2\": [628, 624, 620], // 614\n      \"2.5\": [628, 625, 620, 615],\n      \"3\": [627, 624, 615], // 621\n    },\n    maybeSafari: {\n      \"1.5\": [614],\n      \"2\": [614],\n      \"3\": [621],\n    },\n  },\n\n  /*\n   * iPhone 6\n   * iPhone 6S\n   * iPhone 7\n   * iPhone 8\n   * iPhone SE2\n   */\n  \"667\": {\n    textSizeHeights: [559, 555, 551, 545],\n    textSizeHeightsNoTabs: [667, 665, 663, 661],\n    zoomHeight: {\n      \"1.15\": [559, 555, 551, 545],\n      \"1.25\": [559, 555, 551, 545],\n      \"1.5\": [560, 555, 551], // 545\n      \"1.75\": [558, 555, 551], // 544\n      \"2\": [560, 556, 552, 546],\n      \"2.5\": [560, 555, 550], // 545\n      \"3\": [558, 555, 546], // 552\n    },\n    maybeSafari: {\n      \"1.5\": [545],\n      \"1.75\": [544],\n      \"2.5\": [545],\n      \"3\": [552],\n    },\n  },\n};\n","/* @flow */\nimport { sfvcScreens } from \"./screenHeights\";\n\nexport function getUserAgent(): string {\n  return window.navigator.mockUserAgent || window.navigator.userAgent;\n}\n\nconst TABLET_PATTERN =\n  /ip(a|ro)d|silk|xoom|playbook|tablet|kindle|Nexus 7|GT-P10|SC-01C|SHW-M180S|SM-T320|SGH-T849|SCH-I800|SHW-M180L|SPH-P100|SGH-I987|zt180|HTC( Flyer|_Flyer)|Sprint ATP51|ViewPad7|pandigital(sprnova|nova)|Ideos S7|Dell Streak 7|Advent Vega|A101IT|A70BHT|MID7015|Next2|nook|FOLIO|MB511.*RUTEM|Mac OS.*Silk/i;\n\nexport function isDevice(userAgent?: string = getUserAgent()): boolean {\n  if (\n    userAgent.match(\n      /Android|webOS|iPhone|iPad|iPod|bada|Symbian|Palm|CriOS|BlackBerry|IEMobile|WindowsMobile|Opera Mini/i\n    )\n  ) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function isTablet(userAgent?: string = getUserAgent()): boolean {\n  return TABLET_PATTERN.test(userAgent);\n}\n\nexport function isWebView(): boolean {\n  const userAgent = getUserAgent();\n  return (\n    /(iPhone|iPod|iPad|Macintosh).*AppleWebKit(?!.*Safari)|.*WKWebView/i.test(\n      userAgent\n    ) ||\n    /\\bwv\\b/.test(userAgent) ||\n    /Android.*Version\\/(\\d)\\.(\\d)/i.test(userAgent)\n  );\n}\n\nexport function isStandAlone(): boolean {\n  return (\n    window.navigator.standalone === true ||\n    window.matchMedia(\"(display-mode: standalone)\").matches\n  );\n}\n\nexport function isFacebookWebView(ua?: string = getUserAgent()): boolean {\n  return /FBAN/.test(ua) || /FBAV/.test(ua);\n}\n\nexport function isFirefox(ua?: string = getUserAgent()): boolean {\n  return /Firefox/i.test(ua);\n}\n\nexport function isFirefoxIOS(ua?: string = getUserAgent()): boolean {\n  return /FxiOS/i.test(ua);\n}\n\nexport function isEdgeIOS(ua?: string = getUserAgent()): boolean {\n  return /EdgiOS/i.test(ua);\n}\n\nexport function isOperaMini(ua?: string = getUserAgent()): boolean {\n  return /Opera Mini/i.test(ua);\n}\n\nexport function isAndroid(ua?: string = getUserAgent()): boolean {\n  return /Android/.test(ua);\n}\n\nexport function isIos(ua?: string = getUserAgent()): boolean {\n  return /iPhone|iPod|iPad/.test(ua);\n}\n\nexport function isIOS14(ua?: string = getUserAgent()): boolean {\n  return /iPhone.*OS.*(1)?(?:(1)[0-4]| [0-9])_/.test(ua);\n}\n\nexport function isGoogleSearchApp(ua?: string = getUserAgent()): boolean {\n  return /\\bGSA\\b/.test(ua);\n}\n\nexport function isQQBrowser(ua?: string = getUserAgent()): boolean {\n  return /QQBrowser/.test(ua);\n}\n\nexport function isIosWebview(ua?: string = getUserAgent()): boolean {\n  if (isIos(ua)) {\n    if (isGoogleSearchApp(ua)) {\n      return true;\n    }\n    return /.+AppleWebKit(?!.*Safari)|.*WKWebView/.test(ua);\n  }\n  return false;\n}\n\nexport function isSFVC(ua?: string = getUserAgent()): boolean {\n  if (isIos(ua)) {\n    const height = window.innerHeight;\n    const scale =\n      Math.round((window.screen.width / window.innerWidth) * 100) / 100;\n    const computedHeight = Math.round(height * scale);\n\n    let device = null;\n    if (isIOS14(ua)) {\n      device = sfvcScreens[window.outerHeight];\n    } else {\n      if (scale !== 1) {\n        return true;\n      }\n\n      device = sfvcScreens[window.outerHeight];\n    }\n\n    if (!device) {\n      return true;\n    }\n\n    if (scale > 1 && device.zoomHeight && device.zoomHeight[scale]) {\n      return device.zoomHeight[scale].indexOf(computedHeight) !== -1;\n    } else {\n      return (\n        device.textSizeHeights.indexOf(computedHeight) !== -1 ||\n        device.textSizeHeightsNoTabs.indexOf(computedHeight) !== -1\n      );\n    }\n  }\n  return false;\n}\n\nexport function isSFVCorSafari(ua?: string = getUserAgent()): boolean {\n  if (isIos(ua)) {\n    const sfvc = isSFVC(ua);\n\n    const device = isIOS14(ua) ? sfvcScreens[window.outerHeight] : null;\n\n    if (!device) {\n      return false;\n    }\n\n    const height = window.innerHeight;\n    const scale =\n      Math.round((window.screen.width / window.innerWidth) * 100) / 100;\n\n    const computedHeight = Math.round(height * scale);\n    const possibleSafariSizes = device.maybeSafari;\n\n    let maybeSafari = false;\n    if (\n      scale > 1 &&\n      possibleSafariSizes[scale] &&\n      possibleSafariSizes[scale].indexOf(computedHeight) !== -1\n    ) {\n      maybeSafari = true;\n    }\n\n    return sfvc || maybeSafari;\n  }\n  return false;\n}\n\nexport function isAndroidWebview(ua?: string = getUserAgent()): boolean {\n  if (isAndroid(ua)) {\n    return /Version\\/[\\d.]+/.test(ua) && !isOperaMini(ua);\n  }\n  return false;\n}\n\nexport function isIE(): boolean {\n  if (window.document.documentMode) {\n    return true;\n  }\n\n  return Boolean(\n    window.navigator &&\n      window.navigator.userAgent &&\n      /Edge|MSIE|rv:11/i.test(window.navigator.userAgent)\n  );\n}\n\nexport function isIECompHeader(): boolean {\n  const mHttp = window.document.querySelector(\n    'meta[http-equiv=\"X-UA-Compatible\"]'\n  );\n  const mContent = window.document.querySelector('meta[content=\"IE=edge\"]');\n  if (mHttp && mContent) {\n    return true;\n  }\n  return false;\n}\n\nexport function isElectron(): boolean {\n  if (\n    typeof process !== \"undefined\" &&\n    process.versions &&\n    process.versions.electron\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function isIEIntranet(): boolean {\n  // This status check only works for older versions of IE with document.documentMode set\n\n  if (window.document.documentMode) {\n    try {\n      const status = window.status;\n\n      window.status = \"testIntranetMode\";\n\n      if (window.status === \"testIntranetMode\") {\n        window.status = status;\n\n        return true;\n      }\n\n      return false;\n    } catch (err) {\n      return false;\n    }\n  }\n\n  return false;\n}\n\nexport function isMacOsCna(): boolean {\n  const userAgent = getUserAgent();\n  return /Macintosh.*AppleWebKit(?!.*Safari)/i.test(userAgent);\n}\n\nexport function supportsPopups(ua?: string = getUserAgent()): boolean {\n  return !(\n    isIosWebview(ua) ||\n    isAndroidWebview(ua) ||\n    isOperaMini(ua) ||\n    isFirefoxIOS(ua) ||\n    isEdgeIOS(ua) ||\n    isFacebookWebView(ua) ||\n    isQQBrowser(ua) ||\n    isElectron() ||\n    isMacOsCna() ||\n    isStandAlone()\n  );\n}\n\nexport function isChrome(ua?: string = getUserAgent()): boolean {\n  return (\n    /Chrome|Chromium|CriOS/.test(ua) && !/SamsungBrowser|Silk|EdgA/.test(ua)\n  );\n}\n\nexport function isSafari(ua?: string = getUserAgent()): boolean {\n  return /Safari/.test(ua) && !isChrome(ua) && !/Silk|FxiOS|EdgiOS/.test(ua);\n}\n\nexport function isApplePaySupported(): boolean {\n  try {\n    if (\n      window.ApplePaySession &&\n      window.ApplePaySession.supportsVersion(3) &&\n      window.ApplePaySession.canMakePayments()\n    ) {\n      return true;\n    }\n  } catch (e) {\n    return false;\n  }\n\n  return false;\n}\n\nexport function isCrossSiteTrackingEnabled(expectedCookieKey: string): boolean {\n  return window.document.cookie.indexOf(expectedCookieKey) === -1;\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","/* @flow */\n\nexport function isPromise(item : mixed) : boolean {\n    try {\n        if (!item) {\n            return false;\n        }\n\n        if (typeof Promise !== 'undefined' && item instanceof Promise) {\n            return true;\n        }\n\n        if (typeof window !== 'undefined' && typeof window.Window === 'function' && item instanceof window.Window) {\n            return false;\n        }\n\n        if (typeof window !== 'undefined' && typeof window.constructor === 'function' && item instanceof window.constructor) {\n            return false;\n        }\n\n        const toString = ({}).toString;\n\n        if (toString) {\n            const name = toString.call(item);\n\n            if (name === '[object Window]' || name === '[object global]' || name === '[object DOMWindow]') {\n                return false;\n            }\n        }\n\n        if (typeof item.then === 'function') {\n            return true;\n        }\n    } catch (err) {\n        return false;\n    }\n\n    return false;\n}\n","/* @flow */\n\nimport type { ZalgoPromise } from './promise';\n\nconst dispatchedErrors = [];\nconst possiblyUnhandledPromiseHandlers : Array<(mixed, promise? : ZalgoPromise<mixed>) => void> = [];\n\nexport function dispatchPossiblyUnhandledError<T>(err : mixed, promise : ZalgoPromise<T>) {\n\n    if (dispatchedErrors.indexOf(err) !== -1) {\n        return;\n    }\n\n    dispatchedErrors.push(err);\n\n    setTimeout(() => {\n        if (__DEBUG__) {\n            // $FlowFixMe\n            throw new Error(`${ err.stack || err.toString() }\\n\\nFrom promise:\\n\\n${ promise.stack }`);\n        }\n\n        throw err;\n    }, 1);\n\n    for (let j = 0; j < possiblyUnhandledPromiseHandlers.length; j++) {\n        // $FlowFixMe\n        possiblyUnhandledPromiseHandlers[j](err, promise);\n    }\n}\n\nexport function onPossiblyUnhandledException(handler : (mixed, promise? : ZalgoPromise<mixed>) => void) : {| cancel : () => void |} {\n    possiblyUnhandledPromiseHandlers.push(handler);\n\n    return {\n        cancel() {\n            possiblyUnhandledPromiseHandlers.splice(possiblyUnhandledPromiseHandlers.indexOf(handler), 1);\n        }\n    };\n}\n","/* @flow */\n\nimport type { ZalgoPromise } from './promise';\n\nlet activeCount = 0;\nlet flushPromise;\n\nfunction flushActive() {\n    if (!activeCount && flushPromise) {\n        const promise = flushPromise;\n        flushPromise = null;\n        promise.resolve();\n    }\n}\n\nexport function startActive() {\n    activeCount += 1;\n}\n\nexport function endActive() {\n    activeCount -= 1;\n    flushActive();\n}\n\nexport function awaitActive(Zalgo : Class<ZalgoPromise<*>>) : ZalgoPromise<void> { // eslint-disable-line no-undef\n    const promise = flushPromise = flushPromise || new Zalgo();\n    flushActive();\n    return promise;\n}\n","/* @flow */\n/* eslint no-use-before-define: off */\n\nimport { isPromise } from './utils';\nimport { onPossiblyUnhandledException, dispatchPossiblyUnhandledError } from './exceptions';\nimport { startActive, endActive, awaitActive } from './flush';\n\nexport class ZalgoPromise<R : mixed> {\n\n    resolved : boolean;\n    rejected : boolean;\n    errorHandled : boolean;\n    value : R;\n    error : mixed;\n    // eslint-disable-next-line flowtype/no-mutable-array\n    handlers : Array<{|\n        promise : ZalgoPromise<*>,\n        onSuccess : void | (result : R) => mixed,\n        onError : void | (error : mixed) => mixed\n    |}>;\n    dispatching : boolean;\n    stack : string;\n\n    constructor(handler : ?(resolve : (result : R) => void, reject : (error : mixed) => void) => void) {\n\n        this.resolved = false;\n        this.rejected = false;\n        this.errorHandled = false;\n\n        this.handlers = [];\n\n        if (handler) {\n\n            let result;\n            let error;\n            let resolved = false;\n            let rejected = false;\n            let isAsync = false;\n\n            startActive();\n\n            try {\n                handler(res => {\n                    if (isAsync) {\n                        this.resolve(res);\n                    } else {\n                        resolved = true;\n                        result = res;\n                    }\n\n                }, err => {\n                    if (isAsync) {\n                        this.reject(err);\n                    } else {\n                        rejected = true;\n                        error = err;\n                    }\n                });\n\n            } catch (err) {\n                endActive();\n                this.reject(err);\n                return;\n            }\n\n            endActive();\n\n            isAsync = true;\n\n            if (resolved) {\n                // $FlowFixMe\n                this.resolve(result);\n            } else if (rejected) {\n                this.reject(error);\n            }\n        }\n\n        if (__DEBUG__) {\n            try {\n                throw new Error(`ZalgoPromise`);\n            } catch (err) {\n                this.stack = err.stack;\n            }\n        }\n    }\n\n    resolve(result : R) : ZalgoPromise<R> {\n        if (this.resolved || this.rejected) {\n            return this;\n        }\n\n        if (isPromise(result)) {\n            throw new Error('Can not resolve promise with another promise');\n        }\n\n        this.resolved = true;\n        this.value = result;\n        this.dispatch();\n\n        return this;\n    }\n\n    reject(error : mixed) : ZalgoPromise<R> {\n        if (this.resolved || this.rejected) {\n            return this;\n        }\n\n        if (isPromise(error)) {\n            throw new Error('Can not reject promise with another promise');\n        }\n\n        if (!error) {\n            // $FlowFixMe\n            const err = (error && typeof error.toString === 'function' ? error.toString() : Object.prototype.toString.call(error));\n            error = new Error(`Expected reject to be called with Error, got ${ err }`);\n        }\n\n        this.rejected = true;\n        this.error = error;\n\n        if (!this.errorHandled) {\n            setTimeout(() => {\n                if (!this.errorHandled) {\n                    dispatchPossiblyUnhandledError(error, this);\n                }\n            }, 1);\n        }\n\n        this.dispatch();\n\n        return this;\n    }\n\n    asyncReject(error : mixed) : ZalgoPromise<R> {\n        this.errorHandled = true;\n        this.reject(error);\n        return this;\n    }\n\n    dispatch() {\n\n        const { dispatching, resolved, rejected, handlers } = this;\n\n        if (dispatching) {\n            return;\n        }\n\n        if (!resolved && !rejected) {\n            return;\n        }\n\n        this.dispatching = true;\n        startActive();\n\n        const chain = <T>(firstPromise : ZalgoPromise<T>, secondPromise : ZalgoPromise<T>) => {\n            return firstPromise.then(res => {\n                secondPromise.resolve(res);\n            }, err => {\n                secondPromise.reject(err);\n            });\n        };\n\n        for (let i = 0; i < handlers.length; i++) {\n\n            const { onSuccess, onError, promise } = handlers[i];\n\n            let result;\n\n            if (resolved) {\n\n                try {\n                    result = onSuccess ? onSuccess(this.value) : this.value;\n                } catch (err) {\n                    promise.reject(err);\n                    continue;\n                }\n\n            } else if (rejected) {\n\n                if (!onError) {\n                    promise.reject(this.error);\n                    continue;\n                }\n\n                try {\n                    result = onError(this.error);\n                } catch (err) {\n                    promise.reject(err);\n                    continue;\n                }\n            }\n\n            if (result instanceof ZalgoPromise && (result.resolved || result.rejected)) {\n                const promiseResult : ZalgoPromise<*> = result;\n\n                if (promiseResult.resolved) {\n                    promise.resolve(promiseResult.value);\n                } else {\n                    promise.reject(promiseResult.error);\n                }\n\n                promiseResult.errorHandled = true;\n\n            } else if (isPromise(result)) {\n\n                if (result instanceof ZalgoPromise && (result.resolved || result.rejected)) {\n                    if (result.resolved) {\n                        promise.resolve(result.value);\n                    } else {\n                        promise.reject(result.error);\n                    }\n\n                } else {\n                    // $FlowFixMe\n                    chain(result, promise);\n                }\n\n            } else {\n\n                promise.resolve(result);\n            }\n        }\n\n        handlers.length = 0;\n        this.dispatching = false;\n        endActive();\n    }\n\n    then<X, Y>(onSuccess : void | (result : R) => (ZalgoPromise<X> | Y), onError : void | (error : mixed) => (ZalgoPromise<X> | Y)) : ZalgoPromise<X | Y> {\n\n        if (onSuccess && typeof onSuccess !== 'function' && !onSuccess.call) {\n            throw new Error('Promise.then expected a function for success handler');\n        }\n\n        if (onError && typeof onError !== 'function' && !onError.call) {\n            throw new Error('Promise.then expected a function for error handler');\n        }\n\n        const promise = new ZalgoPromise();\n\n        this.handlers.push({\n            promise,\n            onSuccess,\n            onError\n        });\n\n        this.errorHandled = true;\n\n        this.dispatch();\n\n        return promise;\n    }\n\n    catch<X, Y>(onError : (error : mixed) => ZalgoPromise<X> | Y) : ZalgoPromise<X | Y> {\n        // $FlowFixMe incompatible-call\n        const resultPromise : ZalgoPromise<X | Y> = this.then(undefined, onError);\n        return resultPromise;\n    }\n\n    finally(onFinally : () => mixed) : ZalgoPromise<R> {\n\n        if (onFinally && typeof onFinally !== 'function' && !onFinally.call) {\n            throw new Error('Promise.finally expected a function');\n        }\n\n        return this.then((result) => {\n            return ZalgoPromise.try(onFinally)\n                .then(() => {\n                    return result;\n                });\n        }, (err) => {\n            return ZalgoPromise.try(onFinally)\n                .then(() => {\n                    throw err;\n                });\n        });\n    }\n\n    timeout(time : number, err : ?Error) : ZalgoPromise<R> {\n\n        if (this.resolved || this.rejected) {\n            return this;\n        }\n\n        const timeout = setTimeout(() => {\n\n            if (this.resolved || this.rejected) {\n                return;\n            }\n\n            this.reject(err || new Error(`Promise timed out after ${ time }ms`));\n\n        }, time);\n\n        return this.then(result => {\n            clearTimeout(timeout);\n            return result;\n        });\n    }\n\n    // $FlowFixMe\n    toPromise() : Promise<R> {\n        // $FlowFixMe\n        if (typeof Promise === 'undefined') {\n            throw new TypeError(`Could not find Promise`);\n        }\n        // $FlowFixMe\n        return Promise.resolve(this); // eslint-disable-line compat/compat\n    }\n\n    lazy() : ZalgoPromise<R> {\n        this.errorHandled = true;\n        return this;\n    }\n\n    static resolve<X, Y>(value : ZalgoPromise<X> | Y) : ZalgoPromise<X | Y> {\n\n        if (value instanceof ZalgoPromise) {\n            // $FlowFixMe incompatible-type-arg\n            const result : ZalgoPromise<X | Y> = value;\n            return result;\n        }\n\n        if (isPromise(value)) {\n            // $FlowFixMe\n            return new ZalgoPromise((resolve, reject) => value.then(resolve, reject));\n        }\n\n        return new ZalgoPromise().resolve(value);\n    }\n\n    static reject(error : mixed) : ZalgoPromise<R> {\n        return new ZalgoPromise().reject(error);\n    }\n\n    static asyncReject(error : mixed) : ZalgoPromise<R> {\n        return new ZalgoPromise().asyncReject(error);\n    }\n\n    static all<X : $ReadOnlyArray<mixed>>(promises : X) : ZalgoPromise<$TupleMap<X, <Y>(ZalgoPromise<Y> | Y) => Y>> { // eslint-disable-line no-undef\n\n        const promise = new ZalgoPromise();\n        let count = promises.length;\n        // eslint-disable-next-line no-undef, unicorn/prefer-spread\n        const results = ([] : $TupleMap<X, <Y>(ZalgoPromise<Y> | Y) => Y>).slice();\n\n        if (!count) {\n            promise.resolve(results);\n            return promise;\n        }\n\n        const chain = <T>(i : number, firstPromise : ZalgoPromise<T>, secondPromise : ZalgoPromise<T>) => {\n            return firstPromise.then(res => {\n                results[i] = res;\n                count -= 1;\n                if (count === 0) {\n                    promise.resolve(results);\n                }\n            }, err => {\n                secondPromise.reject(err);\n            });\n        };\n\n        for (let i = 0; i < promises.length; i++) {\n            const prom = promises[i];\n\n            if (prom instanceof ZalgoPromise) {\n                if (prom.resolved) {\n                    results[i] = prom.value;\n                    count -= 1;\n                    continue;\n                }\n            } else if (!isPromise(prom)) {\n                results[i] = prom;\n                count -= 1;\n                continue;\n            }\n\n            chain(i, ZalgoPromise.resolve(prom), promise);\n        }\n\n        if (count === 0) {\n            promise.resolve(results);\n        }\n\n        return promise;\n    }\n\n    static hash<O : Object>(promises : O) : ZalgoPromise<$ObjMap<O, <Y>(ZalgoPromise<Y> | Y) => Y>> { // eslint-disable-line no-undef\n        const result = {};\n        const awaitPromises = [];\n\n        for (const key in promises) {\n            if (promises.hasOwnProperty(key)) {\n                const value = promises[key];\n\n                if (isPromise(value)) {\n                    awaitPromises.push(value.then(res => {\n                        result[key] = res;\n                    }));\n                } else {\n                    result[key] = value;\n                }\n            }\n        }\n\n        return ZalgoPromise.all(awaitPromises).then(() => result);\n    }\n\n    static map<T, X>(items : $ReadOnlyArray<T>, method : (T) => (ZalgoPromise<X> | X)) : ZalgoPromise<$ReadOnlyArray<X>> {\n        // $FlowFixMe\n        return ZalgoPromise.all(items.map(method));\n    }\n\n    static onPossiblyUnhandledException(handler : (err : mixed) => void) : {| cancel : () => void |} {\n        return onPossiblyUnhandledException(handler);\n    }\n\n    static try<X, Y, C : mixed, A : $ReadOnlyArray<mixed>>(method : (...args : $ReadOnlyArray<mixed>) => (ZalgoPromise<X> | Y), context? : C, args? : A) : ZalgoPromise<X | Y> {\n\n        if (method && typeof method !== 'function' && !method.call) {\n            throw new Error('Promise.try expected a function');\n        }\n\n        let result : ZalgoPromise<X> | Y;\n\n        startActive();\n\n        try {\n            result = method.apply(context, args || []);\n        } catch (err) {\n            endActive();\n            return ZalgoPromise.reject(err);\n        }\n\n        endActive();\n\n        // $FlowFixMe incompatible-call\n        const resultPromise = ZalgoPromise.resolve(result);\n\n        return resultPromise;\n    }\n\n    static delay(delay : number) : ZalgoPromise<void> {\n        return new ZalgoPromise(resolve => {\n            setTimeout(resolve, delay);\n        });\n    }\n\n    static isPromise(value : mixed) : boolean {\n\n        if (value && value instanceof ZalgoPromise) {\n            return true;\n        }\n\n        return isPromise(value);\n    }\n\n    static flush() : ZalgoPromise<void> {\n        return awaitActive(ZalgoPromise);\n    }\n}\n","/* @flow */\n\nexport const PROTOCOL = {\n  MOCK: (\"mock:\": \"mock:\"),\n  FILE: (\"file:\": \"file:\"),\n  ABOUT: (\"about:\": \"about:\"),\n};\n\nexport const WILDCARD = \"*\";\n\nexport const WINDOW_TYPE = {\n  IFRAME: (\"iframe\": \"iframe\"),\n  POPUP: (\"popup\": \"popup\"),\n};\n","/* @flow */\n/* eslint max-lines: 0 */\n\nimport { isRegex, noop } from \"./util\";\nimport type {\n  CrossDomainWindowType,\n  SameDomainWindowType,\n  DomainMatcher,\n} from \"./types\";\nimport { PROTOCOL, WILDCARD } from \"./constants\";\n\nconst IE_WIN_ACCESS_ERROR = \"Call was rejected by callee.\\r\\n\";\n\nexport function getActualProtocol(win: SameDomainWindowType = window): ?string {\n  return win.location.protocol;\n}\n\nexport function getProtocol(win: SameDomainWindowType = window): ?string {\n  if (win.mockDomain) {\n    const protocol = win.mockDomain.split(\"//\")[0];\n\n    if (protocol) {\n      return protocol;\n    }\n  }\n\n  return getActualProtocol(win);\n}\n\nexport function isFileProtocol(win: SameDomainWindowType = window): boolean {\n  return getProtocol(win) === PROTOCOL.FILE;\n}\n\nexport function isAboutProtocol(win: SameDomainWindowType = window): boolean {\n  return getProtocol(win) === PROTOCOL.ABOUT;\n}\n\nexport function isMockProtocol(win: SameDomainWindowType = window): boolean {\n  return getProtocol(win) === PROTOCOL.MOCK;\n}\n\nexport function getParent(\n  win?: CrossDomainWindowType = window\n): ?CrossDomainWindowType {\n  if (!win) {\n    return;\n  }\n\n  try {\n    if (win.parent && win.parent !== win) {\n      return win.parent;\n    }\n  } catch (err) {\n    // pass\n  }\n}\n\nexport function getOpener(\n  win?: CrossDomainWindowType = window\n): ?CrossDomainWindowType {\n  if (!win) {\n    return;\n  }\n\n  // Make sure we're not actually an iframe which has had window.open() called on us\n  if (getParent(win)) {\n    return;\n  }\n\n  try {\n    return win.opener;\n  } catch (err) {\n    // pass\n  }\n}\n\nexport function canReadFromWindow(\n  win: CrossDomainWindowType | SameDomainWindowType\n): boolean {\n  try {\n    // $FlowFixMe\n    noop(win && win.location && win.location.href);\n    return true;\n  } catch (err) {\n    // pass\n  }\n\n  return false;\n}\n\nexport function getActualDomain(win?: SameDomainWindowType = window): string {\n  const location = win.location;\n\n  if (!location) {\n    throw new Error(`Can not read window location`);\n  }\n\n  const protocol = getActualProtocol(win);\n\n  if (!protocol) {\n    throw new Error(`Can not read window protocol`);\n  }\n\n  if (protocol === PROTOCOL.FILE) {\n    return `${PROTOCOL.FILE}//`;\n  }\n\n  if (protocol === PROTOCOL.ABOUT) {\n    const parent = getParent(win);\n    if (parent && canReadFromWindow(parent)) {\n      // $FlowFixMe\n      return getActualDomain(parent);\n    }\n\n    return `${PROTOCOL.ABOUT}//`;\n  }\n\n  const host = location.host;\n\n  if (!host) {\n    throw new Error(`Can not read window host`);\n  }\n\n  return `${protocol}//${host}`;\n}\n\nexport function getDomain(win?: SameDomainWindowType = window): string {\n  const domain = getActualDomain(win);\n\n  if (domain && win.mockDomain && win.mockDomain.indexOf(PROTOCOL.MOCK) === 0) {\n    return win.mockDomain;\n  }\n\n  return domain;\n}\n\nexport function isBlankDomain(win: CrossDomainWindowType): boolean {\n  try {\n    // $FlowFixMe\n    if (!win.location.href) {\n      return true;\n    }\n\n    if (win.location.href === \"about:blank\") {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  return false;\n}\n\nexport function isActuallySameDomain(win: CrossDomainWindowType): boolean {\n  try {\n    if (win === window) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    const desc = Object.getOwnPropertyDescriptor(win, \"location\");\n\n    if (desc && desc.enumerable === false) {\n      return false;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    // $FlowFixMe\n    if (isAboutProtocol(win) && canReadFromWindow(win)) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    // $FlowFixMe\n    if (isMockProtocol(win) && canReadFromWindow(win)) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    // $FlowFixMe\n    if (getActualDomain(win) === getActualDomain(window)) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  return false;\n}\n\nexport function isSameDomain(\n  win: CrossDomainWindowType | SameDomainWindowType\n): boolean {\n  if (!isActuallySameDomain(win)) {\n    return false;\n  }\n\n  try {\n    if (win === window) {\n      return true;\n    }\n\n    // $FlowFixMe\n    if (isAboutProtocol(win) && canReadFromWindow(win)) {\n      return true;\n    }\n\n    // $FlowFixMe\n    if (getDomain(window) === getDomain(win)) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  return false;\n}\n\nexport function assertSameDomain(\n  win: CrossDomainWindowType | SameDomainWindowType\n): SameDomainWindowType {\n  if (!isSameDomain(win)) {\n    throw new Error(`Expected window to be same domain`);\n  }\n\n  // $FlowFixMe\n  return win;\n}\n\nexport function getParents(\n  win: CrossDomainWindowType\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const result = [];\n\n  try {\n    while (win.parent !== win) {\n      result.push(win.parent);\n      win = win.parent;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  return result;\n}\n\nexport function isAncestorParent(\n  parent: CrossDomainWindowType,\n  child: CrossDomainWindowType\n): boolean {\n  if (!parent || !child) {\n    return false;\n  }\n\n  const childParent = getParent(child);\n\n  if (childParent) {\n    return childParent === parent;\n  }\n\n  if (getParents(child).indexOf(parent) !== -1) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function getFrames(\n  win: CrossDomainWindowType\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const result = [];\n\n  let frames;\n\n  try {\n    frames = win.frames;\n  } catch (err) {\n    frames = win;\n  }\n\n  let len;\n\n  try {\n    len = frames.length;\n  } catch (err) {\n    // pass\n  }\n\n  if (len === 0) {\n    return result;\n  }\n\n  if (len) {\n    for (let i = 0; i < len; i++) {\n      let frame;\n\n      try {\n        frame = frames[i];\n      } catch (err) {\n        continue;\n      }\n\n      result.push(frame);\n    }\n\n    return result;\n  }\n\n  for (let i = 0; i < 100; i++) {\n    let frame;\n\n    try {\n      frame = frames[i];\n    } catch (err) {\n      return result;\n    }\n\n    if (!frame) {\n      return result;\n    }\n\n    result.push(frame);\n  }\n\n  return result;\n}\n\nexport function getAllChildFrames(\n  win: CrossDomainWindowType\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const result = [];\n\n  for (const frame of getFrames(win)) {\n    result.push(frame);\n\n    for (const childFrame of getAllChildFrames(frame)) {\n      result.push(childFrame);\n    }\n  }\n\n  return result;\n}\n\nexport function getTop(\n  win?: CrossDomainWindowType = window\n): ?CrossDomainWindowType {\n  try {\n    if (win.top) {\n      return win.top;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  if (getParent(win) === win) {\n    return win;\n  }\n\n  try {\n    if (isAncestorParent(window, win) && window.top) {\n      return window.top;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    if (isAncestorParent(win, window) && window.top) {\n      return window.top;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  for (const frame of getAllChildFrames(win)) {\n    try {\n      if (frame.top) {\n        return frame.top;\n      }\n    } catch (err) {\n      // pass\n    }\n\n    if (getParent(frame) === frame) {\n      return frame;\n    }\n  }\n}\n\nexport function getNextOpener(\n  win?: CrossDomainWindowType = window\n): ?CrossDomainWindowType {\n  return getOpener(getTop(win) || win);\n}\n\nexport function getUltimateTop(\n  win?: CrossDomainWindowType = window\n): CrossDomainWindowType {\n  const opener = getNextOpener(win);\n\n  if (opener) {\n    return getUltimateTop(opener);\n  }\n\n  return top;\n}\n\nexport function getAllFramesInWindow(\n  win: CrossDomainWindowType\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const top = getTop(win);\n\n  if (!top) {\n    throw new Error(`Can not determine top window`);\n  }\n\n  let result = [...getAllChildFrames(top), top];\n\n  // Win may be in shadow dom\n  if (result.indexOf(win) === -1) {\n    result = [...result, win, ...getAllChildFrames(win)];\n  }\n\n  return result;\n}\n\nexport function getAllWindows(\n  win?: CrossDomainWindowType = window\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const frames = getAllFramesInWindow(win);\n  const opener = getNextOpener(win);\n\n  if (opener) {\n    return [...getAllWindows(opener), ...frames];\n  } else {\n    return frames;\n  }\n}\n\nexport function isTop(win: CrossDomainWindowType): boolean {\n  return win === getTop(win);\n}\n\nexport function isFrameWindowClosed(frame: HTMLIFrameElement): boolean {\n  if (!frame.contentWindow) {\n    return true;\n  }\n\n  if (!frame.parentNode) {\n    return true;\n  }\n\n  const doc = frame.ownerDocument;\n\n  if (doc && doc.documentElement && !doc.documentElement.contains(frame)) {\n    let parent = frame;\n\n    while (parent.parentNode && parent.parentNode !== parent) {\n      parent = parent.parentNode;\n    }\n\n    // $FlowFixMe\n    if (!parent.host || !doc.documentElement.contains(parent.host)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction safeIndexOf<T>(collection: $ReadOnlyArray<T>, item: T): number {\n  for (let i = 0; i < collection.length; i++) {\n    try {\n      if (collection[i] === item) {\n        return i;\n      }\n    } catch (err) {\n      // pass\n    }\n  }\n\n  return -1;\n}\n\nconst iframeWindows = [];\nconst iframeFrames = [];\n\nexport function isWindowClosed(\n  win: CrossDomainWindowType,\n  allowMock: boolean = true\n): boolean {\n  try {\n    if (win === window) {\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (!win) {\n      return true;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (win.closed) {\n      return true;\n    }\n  } catch (err) {\n    // I love you so much IE\n\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return false;\n    }\n\n    return true;\n  }\n\n  if (allowMock && isSameDomain(win)) {\n    try {\n      // $FlowFixMe\n      if (win.mockclosed) {\n        return true;\n      }\n    } catch (err) {\n      // pass\n    }\n  }\n\n  // Mobile safari\n\n  try {\n    if (!win.parent || !win.top) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  // Yes, this actually happens in IE. win === win errors out when the window\n  // is from an iframe, and the iframe was removed from the page.\n\n  try {\n    noop(win === win); // eslint-disable-line no-self-compare\n  } catch (err) {\n    return true;\n  }\n\n  // IE orphaned frame\n\n  const iframeIndex = safeIndexOf(iframeWindows, win);\n\n  if (iframeIndex !== -1) {\n    const frame = iframeFrames[iframeIndex];\n\n    if (frame && isFrameWindowClosed(frame)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction cleanIframes() {\n  for (let i = 0; i < iframeWindows.length; i++) {\n    let closed = false;\n\n    try {\n      closed = iframeWindows[i].closed;\n    } catch (err) {\n      // pass\n    }\n\n    if (closed) {\n      iframeFrames.splice(i, 1);\n      iframeWindows.splice(i, 1);\n    }\n  }\n}\n\nexport function linkFrameWindow(frame: HTMLIFrameElement) {\n  cleanIframes();\n\n  if (frame && frame.contentWindow) {\n    try {\n      iframeWindows.push(frame.contentWindow);\n      iframeFrames.push(frame);\n    } catch (err) {\n      // pass\n    }\n  }\n}\n\nexport function getUserAgent(win: ?SameDomainWindowType): string {\n  win = win || window;\n  return win.navigator.mockUserAgent || win.navigator.userAgent;\n}\n\nexport function getFrameByName(\n  win: CrossDomainWindowType,\n  name: string\n): ?CrossDomainWindowType {\n  const winFrames = getFrames(win);\n\n  for (const childFrame of winFrames) {\n    try {\n      if (\n        isSameDomain(childFrame) &&\n        // $FlowFixMe\n        childFrame.name === name &&\n        winFrames.indexOf(childFrame) !== -1\n      ) {\n        return childFrame;\n      }\n    } catch (err) {\n      // pass\n    }\n  }\n\n  try {\n    // $FlowFixMe\n    if (winFrames.indexOf(win.frames[name]) !== -1) {\n      // $FlowFixMe\n      return win.frames[name];\n    }\n  } catch (err) {\n    // pass\n  }\n\n  try {\n    if (winFrames.indexOf(win[name]) !== -1) {\n      return win[name];\n    }\n  } catch (err) {\n    // pass\n  }\n}\n\nexport function findChildFrameByName(\n  win: CrossDomainWindowType,\n  name: string\n): ?CrossDomainWindowType {\n  const frame = getFrameByName(win, name);\n\n  if (frame) {\n    return frame;\n  }\n\n  for (const childFrame of getFrames(win)) {\n    const namedFrame = findChildFrameByName(childFrame, name);\n\n    if (namedFrame) {\n      return namedFrame;\n    }\n  }\n}\n\nexport function findFrameByName(\n  win: CrossDomainWindowType,\n  name: string\n): ?CrossDomainWindowType {\n  const frame = getFrameByName(win, name);\n\n  if (frame) {\n    return frame;\n  }\n\n  const top = getTop(win) || win;\n\n  return findChildFrameByName(top, name);\n}\n\nexport function isParent(\n  win: CrossDomainWindowType,\n  frame: CrossDomainWindowType\n): boolean {\n  const frameParent = getParent(frame);\n\n  if (frameParent) {\n    return frameParent === win;\n  }\n\n  for (const childFrame of getFrames(win)) {\n    if (childFrame === frame) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function isOpener(\n  parent: CrossDomainWindowType,\n  child: CrossDomainWindowType\n): boolean {\n  return parent === getOpener(child);\n}\n\nexport function getAncestor(\n  win?: CrossDomainWindowType = window\n): ?CrossDomainWindowType {\n  win = win || window;\n\n  const opener = getOpener(win);\n\n  if (opener) {\n    return opener;\n  }\n\n  const parent = getParent(win);\n\n  if (parent) {\n    return parent;\n  }\n}\n\nexport function getAncestors(\n  win: CrossDomainWindowType\n): $ReadOnlyArray<CrossDomainWindowType> {\n  const results = [];\n\n  let ancestor = win;\n\n  while (ancestor) {\n    ancestor = getAncestor(ancestor);\n    if (ancestor) {\n      results.push(ancestor);\n    }\n  }\n\n  return results;\n}\n\nexport function isAncestor(\n  parent: CrossDomainWindowType,\n  child: CrossDomainWindowType\n): boolean {\n  const actualParent = getAncestor(child);\n\n  if (actualParent) {\n    if (actualParent === parent) {\n      return true;\n    }\n\n    return false;\n  }\n\n  if (child === parent) {\n    return false;\n  }\n\n  if (getTop(child) === child) {\n    return false;\n  }\n\n  for (const frame of getFrames(parent)) {\n    if (frame === child) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function isPopup(win?: CrossDomainWindowType = window): boolean {\n  return Boolean(getOpener(win));\n}\n\nexport function isIframe(win?: CrossDomainWindowType = window): boolean {\n  return Boolean(getParent(win));\n}\n\nexport function isFullpage(win?: CrossDomainWindowType = window): boolean {\n  return Boolean(!isIframe(win) && !isPopup(win));\n}\n\nfunction anyMatch(collection1, collection2): boolean {\n  for (const item1 of collection1) {\n    for (const item2 of collection2) {\n      if (item1 === item2) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function getDistanceFromTop(\n  win: CrossDomainWindowType = window\n): number {\n  let distance = 0;\n  let parent = win;\n\n  while (parent) {\n    parent = getParent(parent);\n    if (parent) {\n      distance += 1;\n    }\n  }\n\n  return distance;\n}\n\nexport function getNthParent(\n  win: CrossDomainWindowType,\n  n: number = 1\n): ?CrossDomainWindowType {\n  let parent = win;\n\n  for (let i = 0; i < n; i++) {\n    if (!parent) {\n      return;\n    }\n\n    parent = getParent(parent);\n  }\n\n  return parent;\n}\n\nexport function getNthParentFromTop(\n  win: CrossDomainWindowType,\n  n: number = 1\n): ?CrossDomainWindowType {\n  return getNthParent(win, getDistanceFromTop(win) - n);\n}\n\nexport function isSameTopWindow(\n  win1: CrossDomainWindowType,\n  win2: CrossDomainWindowType\n): boolean {\n  const top1 = getTop(win1) || win1;\n  const top2 = getTop(win2) || win2;\n\n  try {\n    if (top1 && top2) {\n      if (top1 === top2) {\n        return true;\n      }\n\n      return false;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  const allFrames1 = getAllFramesInWindow(win1);\n  const allFrames2 = getAllFramesInWindow(win2);\n\n  if (anyMatch(allFrames1, allFrames2)) {\n    return true;\n  }\n\n  const opener1 = getOpener(top1);\n  const opener2 = getOpener(top2);\n\n  if (opener1 && anyMatch(getAllFramesInWindow(opener1), allFrames2)) {\n    return false;\n  }\n\n  if (opener2 && anyMatch(getAllFramesInWindow(opener2), allFrames1)) {\n    return false;\n  }\n\n  return false;\n}\n\nexport function matchDomain(\n  pattern: DomainMatcher,\n  origin: DomainMatcher\n): boolean {\n  if (typeof pattern === \"string\") {\n    if (typeof origin === \"string\") {\n      return pattern === WILDCARD || origin === pattern;\n    }\n\n    if (isRegex(origin)) {\n      return false;\n    }\n\n    if (Array.isArray(origin)) {\n      return false;\n    }\n  }\n\n  if (isRegex(pattern)) {\n    if (isRegex(origin)) {\n      return pattern.toString() === origin.toString();\n    }\n\n    if (Array.isArray(origin)) {\n      return false;\n    }\n\n    // $FlowFixMe\n    return Boolean(origin.match(pattern));\n  }\n\n  if (Array.isArray(pattern)) {\n    if (Array.isArray(origin)) {\n      return JSON.stringify(pattern) === JSON.stringify(origin);\n    }\n\n    if (isRegex(origin)) {\n      return false;\n    }\n\n    return pattern.some((subpattern) => matchDomain(subpattern, origin));\n  }\n\n  return false;\n}\n\nexport function stringifyDomainPattern(pattern: DomainMatcher): string {\n  if (Array.isArray(pattern)) {\n    return `(${pattern.join(\" | \")})`;\n  } else if (isRegex(pattern)) {\n    return `RegExp(${pattern.toString()})`;\n  } else {\n    return pattern.toString();\n  }\n}\n\nexport function getDomainFromUrl(url: string): string {\n  let domain;\n\n  if (url.match(/^(https?|mock|file):\\/\\//)) {\n    domain = url;\n  } else {\n    return getDomain();\n  }\n\n  domain = domain.split(\"/\").slice(0, 3).join(\"/\");\n\n  return domain;\n}\n\nexport function onCloseWindow(\n  win: CrossDomainWindowType,\n  callback: Function,\n  delay: number = 1000,\n  maxtime: number = Infinity\n): {| cancel: () => void |} {\n  let timeout;\n\n  const check = () => {\n    if (isWindowClosed(win)) {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      return callback();\n    }\n\n    if (maxtime <= 0) {\n      clearTimeout(timeout);\n    } else {\n      maxtime -= delay;\n      timeout = setTimeout(check, delay);\n    }\n  };\n\n  check();\n\n  return {\n    cancel() {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n    },\n  };\n}\n\n// eslint-disable-next-line complexity\nexport function isWindow(obj: Object): boolean {\n  try {\n    if (obj === window) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    // $FlowFixMe method-unbinding\n    if (Object.prototype.toString.call(obj) === \"[object Window]\") {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (window.Window && obj instanceof window.Window) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.self === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.parent === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.top === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    // eslint-disable-next-line no-self-compare\n    if (noop(obj === obj) === \"__unlikely_value__\") {\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (\n      obj &&\n      obj.__cross_domain_utils_window_check__ === \"__unlikely_value__\"\n    ) {\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (\"postMessage\" in obj && \"self\" in obj && \"location\" in obj) {\n      return true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  return false;\n}\n\nexport function isBrowser(): boolean {\n  return (\n    typeof window !== \"undefined\" && typeof window.location !== \"undefined\"\n  );\n}\n\nexport function isCurrentDomain(domain: string): boolean {\n  if (!isBrowser()) {\n    return false;\n  }\n\n  return getDomain() === domain;\n}\n\nexport function isMockDomain(domain: string): boolean {\n  return domain.indexOf(PROTOCOL.MOCK) === 0;\n}\n\nexport function normalizeMockUrl(url: string): string {\n  if (!isMockDomain(getDomainFromUrl(url))) {\n    return url;\n  }\n\n  if (!__TEST__) {\n    throw new Error(`Mock urls not supported out of test mode`);\n  }\n\n  return url.replace(/^mock:\\/\\/[^/]+/, getActualDomain(window));\n}\n\nexport function getFrameForWindow(win: CrossDomainWindowType): ?HTMLElement {\n  if (isSameDomain(win)) {\n    return assertSameDomain(win).frameElement;\n  }\n\n  for (const frame of document.querySelectorAll(\"iframe\")) {\n    if (frame && frame.contentWindow && frame.contentWindow === win) {\n      return frame;\n    }\n  }\n}\n\nexport function closeWindow(win: CrossDomainWindowType) {\n  if (isIframe(win)) {\n    const frame = getFrameForWindow(win);\n    if (frame && frame.parentElement) {\n      frame.parentElement.removeChild(frame);\n      return;\n    }\n  }\n\n  try {\n    win.close();\n  } catch (err) {\n    // pass\n  }\n}\n","/* @flow */\n\nexport function safeIndexOf<T>(collection : $ReadOnlyArray<T>, item : T) : number {\n    for (let i = 0; i < collection.length; i++) {\n\n        try {\n            if (collection[i] === item) {\n                return i;\n            }\n        } catch (err) {\n            // pass\n        }\n    }\n\n    return -1;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function noop(...args : $ReadOnlyArray<mixed>) {\n    // pass\n}\n","/* @flow */\n\nimport { isWindow, isWindowClosed } from '@krakenjs/cross-domain-utils/src';\n\nimport { hasNativeWeakMap } from './native';\nimport { noop, safeIndexOf } from './util';\n\nexport class CrossDomainSafeWeakMap<K : Object, V : mixed> {\n\n    name : string;\n    weakmap : ?WeakMap<K, V>;\n    // eslint-disable-next-line flowtype/no-mutable-array\n    keys : Array<K>;\n    // eslint-disable-next-line flowtype/no-mutable-array\n    values : Array<V>;\n\n    constructor() {\n        // eslint-disable-next-line no-bitwise\n        this.name = `__weakmap_${ Math.random() * 1e9 >>> 0 }__`;\n\n        if (hasNativeWeakMap()) {\n            try {\n                this.weakmap = new WeakMap();\n            } catch (err) {\n                // pass\n            }\n        }\n\n        this.keys  = [];\n        this.values = [];\n    }\n\n    _cleanupClosedWindows() {\n\n        const weakmap = this.weakmap;\n        const keys = this.keys;\n\n        for (let i = 0; i < keys.length; i++) {\n            const value = keys[i];\n\n            if (isWindow(value) && isWindowClosed(value)) {\n\n                if (weakmap) {\n                    try {\n                        weakmap.delete(value);\n                    } catch (err) {\n                        // pass\n                    }\n                }\n\n                keys.splice(i, 1);\n                this.values.splice(i, 1);\n\n                i -= 1;\n            }\n        }\n    }\n\n    isSafeToReadWrite(key : K) : boolean {\n\n        if (isWindow(key)) {\n            return false;\n        }\n\n        try {\n            noop(key && key.self);\n            noop(key && key[this.name]);\n        } catch (err) {\n            return false;\n        }\n\n        return true;\n    }\n\n    set(key : K, value : V) {\n\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                weakmap.set(key, value);\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const name = this.name;\n                const entry = key[name];\n\n                if (entry && entry[0] === key) {\n                    entry[1] = value;\n                } else {\n                    Object.defineProperty(key, name, {\n                        value:    [ key, value ],\n                        writable: true\n                    });\n                }\n\n                return;\n\n            } catch (err) {\n                // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const values = this.values;\n        const index = safeIndexOf(keys, key);\n\n        if (index === -1) {\n            keys.push(key);\n            values.push(value);\n        } else {\n            values[index] = value;\n        }\n    }\n\n    get(key : K) : V | void {\n\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                if (weakmap.has(key)) {\n                    return weakmap.get(key);\n                }\n\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    return entry[1];\n                }\n\n                return;\n            } catch (err) {\n                // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const index = safeIndexOf(keys, key);\n\n        if (index === -1) {\n            return;\n        }\n\n        return this.values[index];\n    }\n\n    delete(key : K) {\n\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                weakmap.delete(key);\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    entry[0] = entry[1] = undefined;\n                }\n            } catch (err) {\n                // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const index = safeIndexOf(keys, key);\n\n        if (index !== -1) {\n            keys.splice(index, 1);\n            this.values.splice(index, 1);\n        }\n    }\n\n    has(key : K) : boolean {\n\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                if (weakmap.has(key)) {\n                    return true;\n                }\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    return true;\n                }\n\n                return false;\n            } catch (err) {\n                // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const index = safeIndexOf(this.keys, key);\n        return index !== -1;\n    }\n\n    getOrSet(key : K, getter : () => V) : V {\n        if (this.has(key)) {\n            // $FlowFixMe\n            return this.get(key);\n        }\n\n        const value = getter();\n        this.set(key, value);\n        return value;\n    }\n}\n","/* @flow */\n/* eslint max-lines: 0 */\n\nimport { ZalgoPromise } from \"@krakenjs/zalgo-promise/src\";\nimport { WeakMap } from \"@krakenjs/cross-domain-safe-weakmap/src\";\n\nimport type { CancelableType } from \"./types\";\n\nexport function isElement(element: mixed): boolean {\n  let passed = false;\n\n  try {\n    if (element instanceof window.Element) {\n      passed = true;\n    } else if (\n      element !== null &&\n      typeof element === \"object\" &&\n      element.nodeType === 1 &&\n      typeof element.style === \"object\" &&\n      typeof element.ownerDocument === \"object\"\n    ) {\n      passed = true;\n    }\n  } catch (_) {\n    // we don't have an element\n  }\n\n  return passed;\n}\n\nexport function getFunctionName<T: Function>(fn: T): string {\n  return fn.name || fn.__name__ || fn.displayName || \"anonymous\";\n}\n\nexport function setFunctionName<T: Function>(fn: T, name: string): T {\n  try {\n    delete fn.name;\n    fn.name = name;\n  } catch (err) {\n    // pass\n  }\n\n  fn.__name__ = fn.displayName = name;\n  return fn;\n}\n\nexport function base64encode(str: string): string {\n  if (typeof btoa === \"function\") {\n    return btoa(\n      encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (m, p1) => {\n        return String.fromCharCode(parseInt(p1, 16));\n      })\n    ).replace(/[=]/g, \"\");\n  }\n\n  if (typeof Buffer !== \"undefined\") {\n    return Buffer.from(str, \"utf8\").toString(\"base64\").replace(/[=]/g, \"\");\n  }\n\n  throw new Error(`Can not find window.btoa or Buffer`);\n}\n\nexport function base64decode(str: string): string {\n  if (typeof atob === \"function\") {\n    return decodeURIComponent(\n      // $FlowFixMe[method-unbinding]\n      Array.prototype.map\n        .call(atob(str), (c) => {\n          // eslint-disable-next-line prefer-template\n          return \"%\" + (\"00\" + c.charCodeAt(0).toString(16)).slice(-2);\n        })\n        .join(\"\")\n    );\n  }\n\n  if (typeof Buffer !== \"undefined\") {\n    return Buffer.from(str, \"base64\").toString(\"utf8\");\n  }\n\n  throw new Error(`Can not find window.atob or Buffer`);\n}\n\nexport function uniqueID(): string {\n  const chars = \"0123456789abcdef\";\n\n  const randomID = \"xxxxxxxxxx\".replace(/./g, () => {\n    return chars.charAt(Math.floor(Math.random() * chars.length));\n  });\n\n  const timeID = base64encode(\n    new Date().toISOString().slice(11, 19).replace(\"T\", \".\")\n  )\n    .replace(/[^a-zA-Z0-9]/g, \"\")\n    .toLowerCase();\n\n  return `uid_${randomID}_${timeID}`;\n}\n\nexport function getGlobal(): Object {\n  if (typeof window !== \"undefined\") {\n    return window;\n  }\n  if (typeof global !== \"undefined\") {\n    return global;\n  }\n  if (typeof __GLOBAL__ !== \"undefined\") {\n    return __GLOBAL__;\n  }\n  throw new Error(`No global found`);\n}\n\nlet objectIDs;\n\nexport function getObjectID(obj: Object): string {\n  objectIDs = objectIDs || new WeakMap();\n\n  if (\n    obj === null ||\n    obj === undefined ||\n    (typeof obj !== \"object\" && typeof obj !== \"function\")\n  ) {\n    throw new Error(`Invalid object`);\n  }\n\n  let uid = objectIDs.get(obj);\n\n  if (!uid) {\n    uid = `${typeof obj}:${uniqueID()}`;\n    objectIDs.set(obj, uid);\n  }\n\n  return uid;\n}\n\nfunction serializeArgs<T>(args: $ReadOnlyArray<T>): string {\n  try {\n    // $FlowFixMe[method-unbinding]\n    return JSON.stringify(Array.prototype.slice.call(args), (subkey, val) => {\n      // Treat each distinct function as unique for purposes of memoization\n      // e.g. even if someFunction.stringify() is the same, we may use a different memoize cache\n      // if the actual function is different.\n      if (typeof val === \"function\") {\n        return `memoize[${getObjectID(val)}]`;\n      }\n\n      // By default JSON.stringify(domElement) returns '{}'. This ensures that stays true even for non-standard\n      // elements (e.g. React-rendered dom elements) with custom properties\n      if (isElement(val)) {\n        return {};\n      }\n\n      return val;\n    });\n  } catch (err) {\n    throw new Error(`Arguments not serializable -- can not be used to memoize`);\n  }\n}\n\nexport function getEmptyObject(): {||} {\n  // $FlowFixMe\n  return {};\n}\n\ntype MemoizeOptions = {|\n  name?: string,\n  time?: number,\n  thisNamespace?: boolean,\n|};\n\nconst getDefaultMemoizeOptions = (): MemoizeOptions => {\n  // $FlowFixMe\n  return {};\n};\n\nexport type Memoized<F> = F & {| reset: () => void |};\n\nlet memoizeGlobalIndex = 0;\nlet memoizeGlobalIndexValidFrom = 0;\n\nexport function memoize<F: Function>(\n  method: F,\n  options?: MemoizeOptions = getDefaultMemoizeOptions()\n): Memoized<F> {\n  const { thisNamespace = false, time: cacheTime } = options;\n\n  let simpleCache;\n  let thisCache;\n\n  let memoizeIndex = memoizeGlobalIndex;\n  memoizeGlobalIndex += 1;\n\n  const memoizedFunction = function memoizedFunction(...args): mixed {\n    if (memoizeIndex < memoizeGlobalIndexValidFrom) {\n      simpleCache = null;\n      thisCache = null;\n      memoizeIndex = memoizeGlobalIndex;\n      memoizeGlobalIndex += 1;\n    }\n\n    let cache;\n\n    if (thisNamespace) {\n      thisCache = thisCache || new WeakMap();\n      cache = thisCache.getOrSet(this, getEmptyObject);\n    } else {\n      cache = simpleCache = simpleCache || {};\n    }\n\n    let cacheKey;\n\n    try {\n      cacheKey = serializeArgs(args);\n    } catch {\n      return method.apply(this, arguments);\n    }\n\n    let cacheResult = cache[cacheKey];\n\n    if (cacheResult && cacheTime && Date.now() - cacheResult.time < cacheTime) {\n      delete cache[cacheKey];\n      cacheResult = null;\n    }\n\n    if (cacheResult) {\n      return cacheResult.value;\n    }\n\n    const time = Date.now();\n    const value = method.apply(this, arguments);\n\n    cache[cacheKey] = { time, value };\n\n    return value;\n  };\n\n  memoizedFunction.reset = () => {\n    simpleCache = null;\n    thisCache = null;\n  };\n\n  // $FlowFixMe\n  const result: F = memoizedFunction;\n\n  return setFunctionName(\n    result,\n    `${options.name || getFunctionName(method)}::memoized`\n  );\n}\n\nmemoize.clear = () => {\n  memoizeGlobalIndexValidFrom = memoizeGlobalIndex;\n};\n\nexport function promiseIdentity<T: mixed>(\n  item: ZalgoPromise<T> | T\n): ZalgoPromise<T> {\n  // $FlowFixMe\n  return ZalgoPromise.resolve(item);\n}\n\nexport function memoizePromise<R>(\n  // eslint-disable-next-line flowtype/no-weak-types\n  method: (...args: $ReadOnlyArray<any>) => ZalgoPromise<R>\n  // eslint-disable-next-line flowtype/no-weak-types\n): (...args: $ReadOnlyArray<any>) => ZalgoPromise<R> {\n  let cache = {};\n\n  function memoizedPromiseFunction(\n    // eslint-disable-next-line flowtype/no-weak-types\n    ...args: $ReadOnlyArray<any>\n  ): ZalgoPromise<R> {\n    const key: string = serializeArgs(args);\n\n    if (cache.hasOwnProperty(key)) {\n      return cache[key];\n    }\n\n    cache[key] = ZalgoPromise.try(() => method.apply(this, arguments)).finally(\n      () => {\n        delete cache[key];\n      }\n    );\n\n    return cache[key];\n  }\n\n  memoizedPromiseFunction.reset = () => {\n    cache = {};\n  };\n\n  return setFunctionName(\n    memoizedPromiseFunction,\n    `${getFunctionName(method)}::promiseMemoized`\n  );\n}\n\ntype PromisifyOptions = {|\n  name?: string,\n|};\n\nconst getDefaultPromisifyOptions = (): PromisifyOptions => {\n  // $FlowFixMe\n  return {};\n};\n\nexport function promisify<R>(\n  // eslint-disable-next-line flowtype/no-weak-types\n  method: (...args: $ReadOnlyArray<any>) => R,\n  options: PromisifyOptions = getDefaultPromisifyOptions()\n  // eslint-disable-next-line flowtype/no-weak-types\n): (...args: $ReadOnlyArray<any>) => ZalgoPromise<R> {\n  function promisifiedFunction(): ZalgoPromise<R> {\n    return ZalgoPromise.try(method, this, arguments);\n  }\n\n  if (options.name) {\n    promisifiedFunction.displayName = `${options.name}:promisified`;\n  }\n\n  return setFunctionName(\n    promisifiedFunction,\n    `${getFunctionName(method)}::promisified`\n  );\n}\n\nexport function inlineMemoize<R>(\n  // eslint-disable-next-line flowtype/no-weak-types\n  method: (...args: $ReadOnlyArray<any>) => R,\n  // eslint-disable-next-line flowtype/no-weak-types\n  logic: (...args: $ReadOnlyArray<any>) => R,\n  // eslint-disable-next-line flowtype/no-weak-types\n  args: $ReadOnlyArray<any> = []\n): R {\n  // $FlowFixMe\n  const cache: {| [string]: R |} = (method.__inline_memoize_cache__ =\n    // $FlowFixMe\n    method.__inline_memoize_cache__ || {});\n  const key = serializeArgs(args);\n\n  if (cache.hasOwnProperty(key)) {\n    return cache[key];\n  }\n\n  const result = (cache[key] = logic(...args));\n\n  return result;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function noop(...args: $ReadOnlyArray<mixed>) {\n  // pass\n}\n\nexport function once(method: Function): Function {\n  let called = false;\n\n  const onceFunction = function (): mixed {\n    if (!called) {\n      called = true;\n      return method.apply(this, arguments);\n    }\n  };\n\n  return setFunctionName(onceFunction, `${getFunctionName(method)}::once`);\n}\n\nexport function hashStr(str: string): number {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash += str[i].charCodeAt(0) * Math.pow((i % 10) + 1, 5);\n  }\n  return Math.floor(Math.pow(Math.sqrt(hash), 5));\n}\n\nexport function strHashStr(str: string): string {\n  let hash = \"\";\n\n  for (let i = 0; i < str.length; i++) {\n    let total = str[i].charCodeAt(0) * i;\n\n    if (str[i + 1]) {\n      total += str[i + 1].charCodeAt(0) * (i - 1);\n    }\n\n    hash += String.fromCharCode(97 + (Math.abs(total) % 26));\n  }\n\n  return hash;\n}\n\nexport function match(str: string, pattern: RegExp): ?string {\n  const regmatch = str.match(pattern);\n  if (regmatch) {\n    return regmatch[1];\n  }\n}\n\nexport function awaitKey<T: mixed>(obj: Object, key: string): ZalgoPromise<T> {\n  return new ZalgoPromise((resolve) => {\n    let value = obj[key];\n\n    if (value) {\n      return resolve(value);\n    }\n\n    delete obj[key];\n\n    Object.defineProperty(obj, key, {\n      configurable: true,\n\n      set(item) {\n        value = item;\n\n        if (value) {\n          resolve(value);\n        }\n      },\n\n      get(): T {\n        return value;\n      },\n    });\n  });\n}\n\nexport function stringifyError(err: mixed, level: number = 1): string {\n  if (level >= 3) {\n    return \"stringifyError stack overflow\";\n  }\n\n  try {\n    if (!err) {\n      // $FlowFixMe[method-unbinding]\n      return `<unknown error: ${Object.prototype.toString.call(err)}>`;\n    }\n\n    if (typeof err === \"string\") {\n      return err;\n    }\n\n    if (err instanceof Error) {\n      const stack = err && err.stack;\n      const message = err && err.message;\n\n      if (stack && message) {\n        if (stack.indexOf(message) !== -1) {\n          return stack;\n        } else {\n          return `${message}\\n${stack}`;\n        }\n      } else if (stack) {\n        return stack;\n      } else if (message) {\n        return message;\n      }\n    }\n\n    if (err && err.toString && typeof err.toString === \"function\") {\n      // $FlowFixMe\n      return err.toString();\n    }\n\n    // $FlowFixMe[method-unbinding]\n    return Object.prototype.toString.call(err);\n  } catch (newErr) {\n    return `Error while stringifying error: ${stringifyError(\n      newErr,\n      level + 1\n    )}`;\n  }\n}\n\nexport function stringifyErrorMessage(err: mixed): string {\n  // $FlowFixMe[method-unbinding]\n  const defaultMessage = `<unknown error: ${Object.prototype.toString.call(\n    err\n  )}>`;\n\n  if (!err) {\n    return defaultMessage;\n  }\n\n  if (err instanceof Error) {\n    return err.message || defaultMessage;\n  }\n\n  if (typeof err.message === \"string\") {\n    return err.message || defaultMessage;\n  }\n\n  return defaultMessage;\n}\n\nexport function stringify(item: mixed): string {\n  if (typeof item === \"string\") {\n    return item;\n  }\n\n  if (item && item.toString && typeof item.toString === \"function\") {\n    // $FlowFixMe\n    return item.toString();\n  }\n\n  // $FlowFixMe[method-unbinding]\n  return Object.prototype.toString.call(item);\n}\n\nexport function domainMatches(hostname: string, domain: string): boolean {\n  hostname = hostname.split(\"://\")[1];\n  const index = hostname.indexOf(domain);\n  return index !== -1 && hostname.slice(index) === domain;\n}\n\nexport function patchMethod(obj: Object, name: string, handler: Function) {\n  const original = obj[name];\n\n  obj[name] = function patchedMethod(): mixed {\n    return handler({\n      context: this,\n      // $FlowFixMe[method-unbinding]\n      args: Array.prototype.slice.call(arguments),\n      original,\n      callOriginal: () => original.apply(this, arguments),\n    });\n  };\n}\n\nexport function extend<T: Object | Function>(obj: T, source: Object): T {\n  if (!source) {\n    return obj;\n  }\n\n  if (Object.assign) {\n    return Object.assign(obj, source);\n  }\n\n  for (const key in source) {\n    if (source.hasOwnProperty(key)) {\n      obj[key] = source[key];\n    }\n  }\n\n  return obj;\n}\n\nexport function values<T>(obj: { [string]: T }): $ReadOnlyArray<T> {\n  if (Object.values) {\n    // $FlowFixMe\n    return Object.values(obj);\n  }\n\n  const result: Array<T> = [];\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      // $FlowFixMe[escaped-generic]\n      result.push(obj[key]);\n    }\n  }\n\n  // $FlowFixMe\n  return result;\n}\n\n// eslint-disable-next-line no-undef\nexport const memoizedValues: <T>({ [string]: T }) => $ReadOnlyArray<T> =\n  memoize(values);\n\nexport function perc(pixels: number, percentage: number): number {\n  return Math.round((pixels * percentage) / 100);\n}\n\nexport function min(...args: $ReadOnlyArray<number>): number {\n  return Math.min(...args);\n}\n\nexport function max(...args: $ReadOnlyArray<number>): number {\n  return Math.max(...args);\n}\n\nexport function roundUp(num: number, nearest: number): number {\n  const remainder = num % nearest;\n  return remainder ? num - remainder + nearest : num;\n}\n\nexport function regexMap<T>(\n  str: string,\n  regexp: RegExp,\n  handler: () => T\n): $ReadOnlyArray<T> {\n  const results = [];\n\n  // $FlowFixMe\n  str.replace(regexp, function regexMapMatcher(item) {\n    results.push(handler ? handler.apply(null, arguments) : item);\n  });\n\n  // $FlowFixMe\n  return results;\n}\n\nexport function svgToBase64(svg: string): string {\n  return `data:image/svg+xml;base64,${base64encode(svg)}`;\n}\n\nexport function objFilter<T, R>(\n  obj: { [string]: T },\n  filter?: (T, ?string) => mixed = Boolean\n): { [string]: R } {\n  const result = {};\n\n  for (const key in obj) {\n    if (!obj.hasOwnProperty(key) || !filter(obj[key], key)) {\n      continue;\n    }\n\n    result[key] = obj[key];\n  }\n\n  return result;\n}\n\nexport function identity<T>(item: T): T {\n  return item;\n}\n\nexport function regexTokenize(\n  text: string,\n  regexp: RegExp\n): $ReadOnlyArray<string> {\n  const result = [];\n  text.replace(regexp, (token) => {\n    result.push(token);\n    return \"\";\n  });\n  return result;\n}\n\nexport function promiseDebounce<T>(\n  method: () => ZalgoPromise<T> | T,\n  delay: number = 50\n): () => ZalgoPromise<T> {\n  let promise;\n  let timeout;\n\n  const promiseDebounced = function (): ZalgoPromise<T> {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    const localPromise = (promise = promise || new ZalgoPromise());\n\n    timeout = setTimeout(() => {\n      promise = null;\n      timeout = null;\n\n      ZalgoPromise.try(method).then(\n        (result) => {\n          localPromise.resolve(result);\n        },\n        (err) => {\n          localPromise.reject(err);\n        }\n      );\n    }, delay);\n\n    return localPromise;\n  };\n\n  return setFunctionName(\n    promiseDebounced,\n    `${getFunctionName(method)}::promiseDebounced`\n  );\n}\n\nexport function safeInterval(\n  method: Function,\n  time: number\n): {| cancel: () => void |} {\n  let timeout;\n\n  function loop() {\n    timeout = setTimeout(() => {\n      method();\n      loop();\n    }, time);\n  }\n\n  loop();\n\n  return {\n    cancel() {\n      clearTimeout(timeout);\n    },\n  };\n}\n\nexport function isInteger(str: string): boolean {\n  return Boolean(str.match(/^[0-9]+$/));\n}\n\nexport function isFloat(str: string): boolean {\n  return Boolean(str.match(/^[0-9]+\\.[0-9]+$/));\n}\n\nexport function serializePrimitive(value: string | number | boolean): string {\n  return value.toString();\n}\n\nexport function deserializePrimitive(value: string): string | number | boolean {\n  if (value === \"true\") {\n    return true;\n  } else if (value === \"false\") {\n    return false;\n  } else if (isInteger(value)) {\n    return parseInt(value, 10);\n  } else if (isFloat(value)) {\n    return parseFloat(value);\n  } else {\n    return value;\n  }\n}\n\nexport function dotify(\n  obj: Object,\n  prefix: string = \"\",\n  newobj: Object = {}\n): { [string]: string } {\n  prefix = prefix ? `${prefix}.` : prefix;\n  for (const key in obj) {\n    if (\n      !obj.hasOwnProperty(key) ||\n      obj[key] === undefined ||\n      obj[key] === null ||\n      typeof obj[key] === \"function\"\n    ) {\n      continue;\n    } else if (\n      obj[key] &&\n      Array.isArray(obj[key]) &&\n      obj[key].length &&\n      obj[key].every((val) => typeof val !== \"object\")\n    ) {\n      newobj[`${prefix}${key}[]`] = obj[key].join(\",\");\n    } else if (obj[key] && typeof obj[key] === \"object\") {\n      newobj = dotify(obj[key], `${prefix}${key}`, newobj);\n    } else {\n      newobj[`${prefix}${key}`] = serializePrimitive(obj[key]);\n    }\n  }\n  return newobj;\n}\n\nexport function undotify(obj: { [string]: string }): Object {\n  const result = {};\n\n  for (let key in obj) {\n    if (!obj.hasOwnProperty(key) || typeof obj[key] !== \"string\") {\n      continue;\n    }\n\n    let value = obj[key];\n\n    if (key.match(/^.+\\[\\]$/)) {\n      key = key.slice(0, -2);\n      value = value.split(\",\").map(deserializePrimitive);\n    } else {\n      value = deserializePrimitive(value);\n    }\n\n    let keyResult = result;\n    const parts = key.split(\".\");\n    for (let i = 0; i < parts.length; i++) {\n      const part = parts[i];\n      const isLast = i + 1 === parts.length;\n      const isIndex = !isLast && isInteger(parts[i + 1]);\n\n      if (\n        part === \"constructor\" ||\n        part === \"prototype\" ||\n        part === \"__proto__\"\n      ) {\n        throw new Error(`Disallowed key: ${part}`);\n      }\n\n      if (isLast) {\n        // $FlowFixMe\n        keyResult[part] = value;\n      } else {\n        // $FlowFixMe\n        keyResult = keyResult[part] = keyResult[part] || (isIndex ? [] : {});\n      }\n    }\n  }\n\n  return result;\n}\n\nexport type EventEmitterType = {|\n  on: (eventName: string, handler: Function) => CancelableType,\n  once: (eventName: string, handler: Function) => CancelableType,\n  trigger: (\n    eventName: string,\n    ...args: $ReadOnlyArray<mixed>\n  ) => ZalgoPromise<void>,\n  triggerOnce: (\n    eventName: string,\n    ...args: $ReadOnlyArray<mixed>\n  ) => ZalgoPromise<void>,\n  reset: () => void,\n|};\n\nexport function eventEmitter(): EventEmitterType {\n  const triggered = {};\n  let handlers = {};\n\n  const emitter = {\n    on(eventName: string, handler: Function): CancelableType {\n      const handlerList = (handlers[eventName] = handlers[eventName] || []);\n\n      handlerList.push(handler);\n\n      let cancelled = false;\n\n      return {\n        cancel() {\n          if (!cancelled) {\n            cancelled = true;\n            handlerList.splice(handlerList.indexOf(handler), 1);\n          }\n        },\n      };\n    },\n\n    once(eventName: string, handler: Function): CancelableType {\n      const listener = emitter.on(eventName, () => {\n        listener.cancel();\n        handler();\n      });\n\n      return listener;\n    },\n\n    trigger(\n      eventName: string,\n      ...args: $ReadOnlyArray<mixed>\n    ): ZalgoPromise<void> {\n      const handlerList = handlers[eventName];\n      const promises = [];\n\n      if (handlerList) {\n        for (const handler of handlerList) {\n          promises.push(ZalgoPromise.try(() => handler(...args)));\n        }\n      }\n\n      return ZalgoPromise.all(promises).then(noop);\n    },\n\n    triggerOnce(\n      eventName: string,\n      ...args: $ReadOnlyArray<mixed>\n    ): ZalgoPromise<void> {\n      if (triggered[eventName]) {\n        return ZalgoPromise.resolve();\n      }\n\n      triggered[eventName] = true;\n      return emitter.trigger(eventName, ...args);\n    },\n\n    reset() {\n      handlers = {};\n    },\n  };\n\n  return emitter;\n}\n\nexport function camelToDasherize(string: string): string {\n  return string.replace(/([A-Z])/g, (g) => {\n    return `-${g.toLowerCase()}`;\n  });\n}\n\nexport function dasherizeToCamel(string: string): string {\n  return string.replace(/-([a-z])/g, (g) => {\n    return g[1].toUpperCase();\n  });\n}\n\nexport function capitalizeFirstLetter(string: string): string {\n  return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n}\n\nexport function get(item: Object, path: string, def: mixed): mixed {\n  if (!path) {\n    return def;\n  }\n\n  const pathParts = path.split(\".\");\n\n  // Loop through each section of our key path\n\n  for (let i = 0; i < pathParts.length; i++) {\n    // If we have an object, we can get the key\n    if (typeof item === \"object\" && item !== null) {\n      item = item[pathParts[i]];\n\n      // Otherwise, we should return the default (undefined if not provided)\n    } else {\n      return def;\n    }\n  }\n\n  // If our final result is undefined, we should return the default\n\n  return item === undefined ? def : item;\n}\n\nexport function safeTimeout(method: Function, time: number) {\n  const interval = safeInterval(() => {\n    time -= 100;\n    if (time <= 0) {\n      interval.cancel();\n      method();\n    }\n  }, 100);\n}\n\nexport function defineLazyProp<T>(\n  obj: Object | $ReadOnlyArray<mixed>,\n  key: string | number,\n  getter: () => T\n) {\n  if (Array.isArray(obj)) {\n    if (typeof key !== \"number\") {\n      throw new TypeError(`Array key must be number`);\n    }\n  } else if (typeof obj === \"object\" && obj !== null) {\n    if (typeof key !== \"string\") {\n      throw new TypeError(`Object key must be string`);\n    }\n  }\n\n  Object.defineProperty(obj, key, {\n    configurable: true,\n    enumerable: true,\n    get: () => {\n      // $FlowFixMe\n      delete obj[key];\n      const value = getter();\n      // $FlowFixMe\n      obj[key] = value;\n      return value;\n    },\n    set: (value: T) => {\n      // $FlowFixMe\n      delete obj[key];\n      // $FlowFixMe\n      obj[key] = value;\n    },\n  });\n}\n\n// eslint-disable-next-line no-undef\nexport function arrayFrom<T>(item: Iterable<T>): $ReadOnlyArray<T> {\n  // $FlowFixMe[method-unbinding]\n  return Array.prototype.slice.call(item);\n}\n\nexport function isObject(item: mixed): boolean {\n  return typeof item === \"object\" && item !== null;\n}\n\nexport function isObjectObject(obj: mixed): boolean {\n  return (\n    // $FlowFixMe[method-unbinding]\n    isObject(obj) && Object.prototype.toString.call(obj) === \"[object Object]\"\n  );\n}\n\nexport function isPlainObject(obj: mixed): boolean {\n  if (!isObjectObject(obj)) {\n    return false;\n  }\n\n  // $FlowFixMe\n  const constructor = obj.constructor;\n\n  if (typeof constructor !== \"function\") {\n    return false;\n  }\n\n  const prototype = constructor.prototype;\n\n  if (!isObjectObject(prototype)) {\n    return false;\n  }\n\n  if (!prototype.hasOwnProperty(\"isPrototypeOf\")) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function replaceObject<T: $ReadOnlyArray<mixed> | Object>(\n  item: T,\n  replacer: (mixed, string | number, string) => mixed,\n  fullKey: string = \"\"\n): T {\n  if (Array.isArray(item)) {\n    const length = item.length;\n    const result: Array<mixed> = [];\n\n    for (let i = 0; i < length; i++) {\n      defineLazyProp(result, i, () => {\n        const itemKey = fullKey ? `${fullKey}.${i}` : `${i}`;\n        const el = item[i];\n\n        let child = replacer(el, i, itemKey);\n\n        if (isPlainObject(child) || Array.isArray(child)) {\n          // $FlowFixMe\n          child = replaceObject(child, replacer, itemKey);\n        }\n\n        return child;\n      });\n    }\n\n    // $FlowFixMe\n    return result;\n  } else if (isPlainObject(item)) {\n    const result = {};\n\n    for (const key in item) {\n      if (!item.hasOwnProperty(key)) {\n        continue;\n      }\n\n      defineLazyProp(result, key, () => {\n        const itemKey = fullKey ? `${fullKey}.${key}` : `${key}`;\n        // $FlowFixMe\n        const el = item[key];\n\n        let child = replacer(el, key, itemKey);\n\n        if (isPlainObject(child) || Array.isArray(child)) {\n          // $FlowFixMe\n          child = replaceObject(child, replacer, itemKey);\n        }\n\n        return child;\n      });\n    }\n\n    // $FlowFixMe\n    return result;\n  } else {\n    throw new Error(`Pass an object or array`);\n  }\n}\n\nexport function copyProp(\n  source: Object,\n  target: Object,\n  name: string,\n  def: mixed\n) {\n  if (source.hasOwnProperty(name)) {\n    const descriptor = Object.getOwnPropertyDescriptor(source, name);\n    // $FlowFixMe\n    Object.defineProperty(target, name, descriptor);\n  } else {\n    target[name] = def;\n  }\n}\n\ntype RegexResultType = {|\n  text: string,\n  groups: $ReadOnlyArray<string>,\n  start: number,\n  end: number,\n  length: number,\n  replace: (text: string) => string,\n|};\n\nexport function regex(\n  pattern: string | RegExp,\n  string: string,\n  start: number = 0\n): ?RegexResultType {\n  if (typeof pattern === \"string\") {\n    // eslint-disable-next-line security/detect-non-literal-regexp\n    pattern = new RegExp(pattern);\n  }\n\n  const result = string.slice(start).match(pattern);\n\n  if (!result) {\n    return;\n  }\n\n  // $FlowFixMe\n  const index: number = result.index;\n  const regmatch = result[0];\n\n  return {\n    text: regmatch,\n    groups: result.slice(1),\n    start: start + index,\n    end: start + index + regmatch.length,\n    length: regmatch.length,\n\n    replace(text: string): string {\n      if (!regmatch) {\n        return \"\";\n      }\n\n      return `${regmatch.slice(0, start + index)}${text}${regmatch.slice(\n        index + regmatch.length\n      )}`;\n    },\n  };\n}\n\nexport function regexAll(\n  pattern: string | RegExp,\n  string: string\n): $ReadOnlyArray<RegexResultType> {\n  const matches = [];\n  let start = 0;\n\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const regmatch = regex(pattern, string, start);\n\n    if (!regmatch) {\n      break;\n    }\n\n    matches.push(regmatch);\n    start = match.end;\n  }\n\n  return matches;\n}\n\nexport function isDefined(value: ?mixed): boolean {\n  return value !== null && value !== undefined;\n}\n\nexport function cycle(method: Function): ZalgoPromise<void> {\n  return ZalgoPromise.try(method).then(() => cycle(method));\n}\n\nexport function debounce<T>(\n  method: (...args: $ReadOnlyArray<mixed>) => T,\n  time: number = 100\n): (...args: $ReadOnlyArray<mixed>) => void {\n  let timeout;\n\n  const debounceWrapper = function () {\n    clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      return method.apply(this, arguments);\n    }, time);\n  };\n\n  return setFunctionName(\n    debounceWrapper,\n    `${getFunctionName(method)}::debounced`\n  );\n}\n\nexport function isRegex(item: mixed): boolean {\n  // $FlowFixMe[method-unbinding]\n  return Object.prototype.toString.call(item) === \"[object RegExp]\";\n}\n\ntype FunctionProxy<T: Function> = (method: T) => T;\n\nexport const weakMapMemoize: FunctionProxy<*> = <R: mixed>(\n  // eslint-disable-next-line flowtype/no-weak-types\n  method: (arg: any) => R\n  // eslint-disable-next-line flowtype/no-weak-types\n): ((...args: $ReadOnlyArray<any>) => R) => {\n  const weakmap = new WeakMap();\n\n  // eslint-disable-next-line flowtype/no-weak-types\n  return function weakmapMemoized(arg: any): R {\n    return weakmap.getOrSet(arg, () => method.call(this, arg));\n  };\n};\n\ntype FunctionPromiseProxy<\n  R: mixed,\n  T: (...args: $ReadOnlyArray<mixed>) => ZalgoPromise<R>\n> = (T) => T;\n\nexport const weakMapMemoizePromise: FunctionPromiseProxy<*, *> = <R: mixed>(\n  // eslint-disable-next-line flowtype/no-weak-types\n  method: (arg: any) => ZalgoPromise<R>\n  // eslint-disable-next-line flowtype/no-weak-types\n): ((...args: $ReadOnlyArray<any>) => ZalgoPromise<R>) => {\n  const weakmap = new WeakMap();\n\n  // eslint-disable-next-line flowtype/no-weak-types\n  return function weakmapMemoizedPromise(arg: any): ZalgoPromise<R> {\n    return weakmap.getOrSet(arg, () =>\n      method.call(this, arg).finally(() => {\n        weakmap.delete(arg);\n      })\n    );\n  };\n};\n\nexport function getOrSet<O: Object, T: mixed>(\n  obj: O,\n  key: string,\n  getter: () => T\n): T {\n  if (obj.hasOwnProperty(key)) {\n    return obj[key];\n  }\n\n  const val = getter();\n  obj[key] = val;\n  return val;\n}\n\nexport type CleanupType = {|\n  set: <T: mixed>(string, T) => T, // eslint-disable-line no-undef\n  register: (Function) => {| cancel: () => void |},\n  all: (err?: mixed) => ZalgoPromise<void>,\n|};\n\nexport function cleanup(obj: Object): CleanupType {\n  const tasks = [];\n  let cleaned = false;\n  let cleanErr;\n\n  const cleaner = {\n    set<T: mixed>(name: string, item: T): T {\n      if (!cleaned) {\n        obj[name] = item;\n        cleaner.register(() => {\n          delete obj[name];\n        });\n      }\n      return item;\n    },\n\n    register(method: Function): {| cancel: () => void |} {\n      const task = once(() => method(cleanErr));\n\n      if (cleaned) {\n        method(cleanErr);\n      } else {\n        tasks.push(task);\n      }\n\n      return {\n        cancel: () => {\n          const index = tasks.indexOf(task);\n          if (index !== -1) {\n            tasks.splice(index, 1);\n          }\n        },\n      };\n    },\n\n    all(err?: mixed): ZalgoPromise<void> {\n      cleanErr = err;\n\n      const results = [];\n      cleaned = true;\n\n      while (tasks.length) {\n        const task = tasks.shift();\n        results.push(task());\n      }\n\n      return ZalgoPromise.all(results).then(noop);\n    },\n  };\n\n  return cleaner;\n}\n\nexport function tryCatch<T>(\n  fn: () => T\n): {| result: T, error: void |} | {| result: void, error: mixed |} {\n  let result;\n  let error;\n\n  try {\n    result = fn();\n  } catch (err) {\n    error = err;\n  }\n\n  // $FlowFixMe\n  return { result, error };\n}\n\n// eslint-disable-next-line flowtype/no-mutable-array\nexport function removeFromArray<X, T: Array<X>>(arr: T, item: X) {\n  const index = arr.indexOf(item);\n  if (index !== -1) {\n    arr.splice(index, 1);\n  }\n}\n\nexport function assertExists<T>(name: string, thing: void | null | T): T {\n  if (thing === null || typeof thing === \"undefined\") {\n    throw new Error(`Expected ${name} to be present`);\n  }\n\n  return thing;\n}\n\nexport function unique(arr: $ReadOnlyArray<string>): $ReadOnlyArray<string> {\n  const result = {};\n  for (const item of arr) {\n    result[item] = true;\n  }\n  return Object.keys(result);\n}\n\nexport const constHas = <X: string | boolean | number, T: { [string]: X }>(\n  constant: T,\n  value: X\n): boolean => {\n  return memoizedValues(constant).indexOf(value) !== -1;\n};\n\nexport function dedupeErrors<T>(handler: (mixed) => T): (mixed) => T | void {\n  const seenErrors = [];\n  const seenStringifiedErrors = {};\n\n  return (err) => {\n    if (seenErrors.indexOf(err) !== -1) {\n      return;\n    }\n\n    seenErrors.push(err);\n\n    const stringifiedError = stringifyError(err);\n    if (seenStringifiedErrors[stringifiedError]) {\n      return;\n    }\n\n    seenStringifiedErrors[stringifiedError] = true;\n    return handler(err);\n  };\n}\n\nexport class ExtendableError extends Error {\n  constructor(message: string) {\n    super(message);\n    // eslint-disable-next-line unicorn/custom-error-definition\n    this.name = this.constructor.name;\n    if (typeof Error.captureStackTrace === \"function\") {\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      this.stack = new Error(message).stack;\n    }\n  }\n}\n","/* @flow */\n\nexport function hasNativeWeakMap() : boolean {\n\n    if (typeof WeakMap === 'undefined') {\n        return false;\n    }\n\n    if (typeof Object.freeze === 'undefined') {\n        return false;\n    }\n\n    try {\n\n        const testWeakMap = new WeakMap();\n        const testKey = {};\n        const testValue = '__testvalue__';\n\n        Object.freeze(testKey);\n\n        testWeakMap.set(testKey, testValue);\n\n        if (testWeakMap.get(testKey) === testValue) {\n            return true;\n        }\n\n        return false;\n\n    } catch (err) {\n\n        return false;\n    }\n}\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeReflectConstruct from \"@babel/runtime/helpers/esm/isNativeReflectConstruct\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeFunction from \"@babel/runtime/helpers/esm/isNativeFunction\";\nimport construct from \"@babel/runtime/helpers/esm/construct\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","/* @flow */\n\nexport const KEY_CODES = {\n  ENTER: 13,\n  SPACE: 32,\n};\n\nexport const ATTRIBUTES = {\n  UID: \"data-uid\",\n};\n\nexport const UID_HASH_LENGTH = 30;\n","/* @flow */\n/* eslint max-lines: off */\nimport { ZalgoPromise } from \"@krakenjs/zalgo-promise/src\";\nimport {\n  linkFrameWindow,\n  isWindowClosed,\n  assertSameDomain,\n  type SameDomainWindowType,\n  type CrossDomainWindowType,\n} from \"@krakenjs/cross-domain-utils/src\";\nimport { WeakMap } from \"@krakenjs/cross-domain-safe-weakmap/src\";\n\nimport {\n  isElement,\n  inlineMemoize,\n  memoize,\n  noop,\n  stringify,\n  capitalizeFirstLetter,\n  once,\n  extend,\n  safeInterval,\n  uniqueID,\n  arrayFrom,\n  ExtendableError,\n  strHashStr,\n} from \"./util\";\nimport { isDevice } from \"./device\";\nimport { KEY_CODES, ATTRIBUTES, UID_HASH_LENGTH } from \"./constants\";\nimport type { CancelableType } from \"./types\";\n\ntype ElementRefType = string | HTMLElement;\n\nexport function getBody(): HTMLBodyElement {\n  // eslint-disable-next-line compat/compat\n  const body = document.body;\n\n  if (!body) {\n    throw new Error(`Body element not found`);\n  }\n\n  return body;\n}\n\nexport function isDocumentReady(): boolean {\n  // eslint-disable-next-line compat/compat\n  return Boolean(document.body) && document.readyState === \"complete\";\n}\n\nexport function isDocumentInteractive(): boolean {\n  // eslint-disable-next-line compat/compat\n  return Boolean(document.body) && document.readyState === \"interactive\";\n}\n\nexport function urlEncode(str: string): string {\n  return encodeURIComponent(str);\n}\n\nexport function waitForWindowReady(): ZalgoPromise<void> {\n  return inlineMemoize(waitForWindowReady, (): ZalgoPromise<void> => {\n    return new ZalgoPromise((resolve) => {\n      if (isDocumentReady()) {\n        resolve();\n      }\n\n      window.addEventListener(\"load\", () => resolve());\n    });\n  });\n}\n\ntype WaitForDocumentReady = () => ZalgoPromise<void>;\n\nexport const waitForDocumentReady: WaitForDocumentReady = memoize(() => {\n  return new ZalgoPromise((resolve) => {\n    if (isDocumentReady() || isDocumentInteractive()) {\n      return resolve();\n    }\n\n    const interval = setInterval(() => {\n      if (isDocumentReady() || isDocumentInteractive()) {\n        clearInterval(interval);\n        return resolve();\n      }\n    }, 10);\n  });\n});\n\nexport function waitForDocumentBody(): ZalgoPromise<HTMLBodyElement> {\n  return ZalgoPromise.try(() => {\n    if (document.body) {\n      return document.body;\n    }\n\n    return waitForDocumentReady().then(() => {\n      if (document.body) {\n        return document.body;\n      }\n\n      throw new Error(\"Document ready but document.body not present\");\n    });\n  });\n}\n\nexport function parseQuery(queryString: string): Object {\n  return inlineMemoize(\n    parseQuery,\n    (): Object => {\n      const params = {};\n\n      if (!queryString) {\n        return params;\n      }\n\n      if (queryString.indexOf(\"=\") === -1) {\n        return params;\n      }\n\n      for (let pair of queryString.split(\"&\")) {\n        pair = pair.split(\"=\");\n\n        if (pair[0] && pair[1]) {\n          params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n        }\n      }\n\n      return params;\n    },\n    [queryString]\n  );\n}\n\nexport function getQueryParam(name: string): string {\n  return parseQuery(window.location.search.slice(1))[name];\n}\n\nexport function urlWillRedirectPage(url: string): boolean {\n  if (url.indexOf(\"#\") === -1) {\n    return true;\n  }\n\n  if (url.indexOf(\"#\") === 0) {\n    return false;\n  }\n\n  if (url.split(\"#\")[0] === window.location.href.split(\"#\")[0]) {\n    return false;\n  }\n\n  return true;\n}\n\nexport type Query = {\n  [string]: boolean | string,\n};\n\nexport function formatQuery(obj: Query = {}): string {\n  return Object.keys(obj)\n    .filter((key) => {\n      return typeof obj[key] === \"string\" || typeof obj[key] === \"boolean\";\n    })\n    .map((key) => {\n      const val = obj[key];\n\n      if (typeof val !== \"string\" && typeof val !== \"boolean\") {\n        throw new TypeError(`Invalid type for query`);\n      }\n\n      return `${urlEncode(key)}=${urlEncode(val.toString())}`;\n    })\n    .join(\"&\");\n}\n\nexport function extendQuery(originalQuery: string, props: Query = {}): string {\n  if (!props || !Object.keys(props).length) {\n    return originalQuery;\n  }\n\n  return formatQuery({\n    ...parseQuery(originalQuery),\n    ...props,\n  });\n}\n\nexport function extendUrl(\n  url: string,\n  options: {| query?: Query, hash?: Query |}\n): string {\n  const query = options.query || {};\n  const hash = options.hash || {};\n\n  let originalUrl;\n  let originalQuery;\n  let originalHash;\n\n  [originalUrl, originalHash] = url.split(\"#\");\n  [originalUrl, originalQuery] = originalUrl.split(\"?\");\n\n  const queryString = extendQuery(originalQuery, query);\n  const hashString = extendQuery(originalHash, hash);\n\n  if (queryString) {\n    originalUrl = `${originalUrl}?${queryString}`;\n  }\n\n  if (hashString) {\n    originalUrl = `${originalUrl}#${hashString}`;\n  }\n\n  return originalUrl;\n}\n\nexport function redirect(\n  url: string,\n  win: CrossDomainWindowType = window\n): ZalgoPromise<void> {\n  return new ZalgoPromise((resolve) => {\n    win.location = url;\n    if (!urlWillRedirectPage(url)) {\n      resolve();\n    }\n  });\n}\n\nexport function hasMetaViewPort(): boolean {\n  const meta = document.querySelector(\"meta[name=viewport]\");\n\n  if (isDevice() && window.screen.width < 660 && !meta) {\n    return false;\n  }\n\n  return true;\n}\n\nexport function isElementVisible(el: HTMLElement): boolean {\n  return Boolean(\n    el.offsetWidth || el.offsetHeight || el.getClientRects().length\n  );\n}\n\nexport function getPerformance(): ?Performance {\n  return inlineMemoize(getPerformance, (): ?Performance => {\n    const performance = window.performance;\n\n    if (\n      performance &&\n      performance.now &&\n      performance.timing &&\n      performance.timing.connectEnd &&\n      performance.timing.navigationStart &&\n      Math.abs(performance.now() - Date.now()) > 1000 &&\n      performance.now() -\n        (performance.timing.connectEnd - performance.timing.navigationStart) >\n        0\n    ) {\n      return performance;\n    }\n  });\n}\n\nexport function enablePerformance(): boolean {\n  return Boolean(getPerformance());\n}\n\nexport function getPageRenderTime(): ZalgoPromise<?number> {\n  return waitForDocumentReady().then(() => {\n    const performance = getPerformance();\n\n    if (!performance) {\n      return;\n    }\n\n    const timing = performance.timing;\n\n    if (timing.connectEnd && timing.domInteractive) {\n      return timing.domInteractive - timing.connectEnd;\n    }\n  });\n}\n\nexport function htmlEncode(html: string = \"\"): string {\n  return html\n    .toString()\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#39;\")\n    .replace(/\\//g, \"&#x2F;\");\n}\n\nexport function isBrowser(): boolean {\n  return typeof window !== \"undefined\" && window.location !== undefined;\n}\n\nexport function querySelectorAll(\n  selector: string,\n  doc: HTMLElement = window.document\n): $ReadOnlyArray<HTMLElement> {\n  // $FlowFixMe[method-unbinding]\n  return Array.prototype.slice.call(doc.querySelectorAll(selector));\n}\n\n/**\n * Sets up event handlers for click events and\n * enter/space keypresses.\n * @callback handler\n * @param {HTMLElement} element\n * @param {handler} handler\n */\nexport function onClick(element: HTMLElement, handler: (Event) => void) {\n  element.addEventListener(\"touchstart\", noop, { passive: true });\n  element.addEventListener(\"click\", handler);\n  element.addEventListener(\"keypress\", (event: Event) => {\n    if (\n      // $FlowFixMe\n      event.keyCode === KEY_CODES.ENTER ||\n      // $FlowFixMe\n      event.keyCode === KEY_CODES.SPACE\n    ) {\n      return handler(event);\n    }\n  });\n}\n\nexport function getScript({\n  host = window.location.host,\n  path,\n  reverse = false,\n}: {|\n  host?: string,\n  path: string,\n  reverse?: boolean,\n|}): ?HTMLScriptElement {\n  return inlineMemoize(\n    getScript,\n    (): ?HTMLScriptElement => {\n      const url = `${host}${path}`;\n      // $FlowFixMe[method-unbinding]\n      const scripts = Array.prototype.slice.call(\n        document.getElementsByTagName(\"script\")\n      );\n\n      if (reverse) {\n        scripts.reverse();\n      }\n\n      for (const script of scripts) {\n        if (!script.src) {\n          continue;\n        }\n\n        const src = script.src.replace(/^https?:\\/\\//, \"\").split(\"?\")[0];\n\n        if (src === url) {\n          return script;\n        }\n      }\n    },\n    [path]\n  );\n}\n\nexport function isLocalStorageEnabled(): boolean {\n  return inlineMemoize(isLocalStorageEnabled, () => {\n    try {\n      if (typeof window === \"undefined\") {\n        return false;\n      }\n\n      if (window.localStorage) {\n        const value = Math.random().toString();\n        window.localStorage.setItem(\"__test__localStorage__\", value);\n        const result = window.localStorage.getItem(\"__test__localStorage__\");\n        window.localStorage.removeItem(\"__test__localStorage__\");\n        if (value === result) {\n          return true;\n        }\n      }\n    } catch (err) {\n      // pass\n    }\n    return false;\n  });\n}\n\nexport function getBrowserLocales(): $ReadOnlyArray<{|\n  country?: string,\n  lang: string,\n|}> {\n  const nav = window.navigator;\n\n  const locales = nav.languages ? [...nav.languages] : [];\n\n  if (nav.language) {\n    locales.push(nav.language);\n  }\n\n  if (nav.userLanguage) {\n    locales.push(nav.userLanguage);\n  }\n\n  return locales\n    .map((locale) => {\n      if (locale && locale.match(/^[a-z]{2}[-_][A-Z]{2}$/)) {\n        const [lang, country] = locale.split(/[-_]/);\n        return { country, lang };\n      }\n\n      if (locale && locale.match(/^[a-z]{2}$/)) {\n        return { lang: locale };\n      }\n\n      return null;\n    })\n    .filter(Boolean);\n}\n\nexport function appendChild(container: HTMLElement, child: HTMLElement | Text) {\n  container.appendChild(child);\n}\n\nexport function getElementSafe(\n  id: ElementRefType,\n  doc: Document | HTMLElement = document\n): ?HTMLElement {\n  if (isElement(id)) {\n    // $FlowFixMe\n    return id;\n  }\n\n  if (typeof id === \"string\") {\n    return doc.querySelector(id);\n  }\n}\n\nexport function getElement(\n  id: ElementRefType,\n  doc: Document | HTMLElement = document\n): HTMLElement {\n  const element = getElementSafe(id, doc);\n\n  if (element) {\n    return element;\n  }\n\n  throw new Error(`Can not find element: ${stringify(id)}`);\n}\n\nexport function elementReady(id: ElementRefType): ZalgoPromise<HTMLElement> {\n  return new ZalgoPromise((resolve, reject) => {\n    const name = stringify(id);\n    let el = getElementSafe(id);\n\n    if (el) {\n      return resolve(el);\n    }\n\n    if (isDocumentReady()) {\n      return reject(\n        new Error(`Document is ready and element ${name} does not exist`)\n      );\n    }\n\n    const interval = setInterval(() => {\n      el = getElementSafe(id);\n\n      if (el) {\n        resolve(el);\n        clearInterval(interval);\n        return;\n      }\n\n      if (isDocumentReady()) {\n        clearInterval(interval);\n        return reject(\n          new Error(`Document is ready and element ${name} does not exist`)\n        );\n      }\n    }, 10);\n  });\n}\n\n// eslint-disable-next-line unicorn/custom-error-definition\nexport class PopupOpenError extends ExtendableError {}\n\ntype PopupOptions = {|\n  name?: string,\n  width?: number,\n  height?: number,\n  top?: number,\n  left?: number,\n  status?: 0 | 1,\n  resizable?: 0 | 1,\n  toolbar?: 0 | 1,\n  menubar?: 0 | 1,\n  scrollbars?: 0 | 1,\n  closeOnUnload?: 0 | 1,\n|};\n\nexport function popup(\n  url: string,\n  options?: PopupOptions\n): CrossDomainWindowType {\n  // $FlowFixMe\n  options = options || {};\n\n  const { closeOnUnload = 1, name = \"\", width, height } = options;\n\n  let top = 0;\n  let left = 0;\n\n  if (width) {\n    if (window.outerWidth) {\n      left = Math.round((window.outerWidth - width) / 2) + window.screenX;\n    } else if (window.screen.width) {\n      left = Math.round((window.screen.width - width) / 2);\n    }\n  }\n\n  if (height) {\n    if (window.outerHeight) {\n      top = Math.round((window.outerHeight - height) / 2) + window.screenY;\n    } else if (window.screen.height) {\n      top = Math.round((window.screen.height - height) / 2);\n    }\n  }\n\n  delete options.closeOnUnload;\n  delete options.name;\n\n  if (width && height) {\n    // $FlowFixMe\n    options = {\n      top,\n      left,\n      width,\n      height,\n      status: 1,\n      toolbar: 0,\n      menubar: 0,\n      resizable: 1,\n      scrollbars: 1,\n      ...options,\n    };\n  }\n\n  const params = Object.keys(options)\n    // eslint-disable-next-line array-callback-return\n    .map((key) => {\n      // $FlowFixMe\n      if (options[key] !== null && options[key] !== undefined) {\n        return `${key}=${stringify(options[key])}`;\n      }\n    })\n    .filter(Boolean)\n    .join(\",\");\n\n  let win;\n\n  try {\n    win = window.open(url, name, params);\n  } catch (err) {\n    throw new PopupOpenError(\n      `Can not open popup window - ${err.stack || err.message}`\n    );\n  }\n\n  if (isWindowClosed(win)) {\n    const err = new PopupOpenError(`Can not open popup window - blocked`);\n    throw err;\n  }\n\n  if (closeOnUnload) {\n    window.addEventListener(\"unload\", () => win.close());\n  }\n\n  return win;\n}\n\nexport function writeToWindow(win: SameDomainWindowType, html: string) {\n  try {\n    win.document.open();\n    win.document.write(html);\n    win.document.close();\n  } catch (err) {\n    try {\n      win.location = `javascript: document.open(); document.write(${JSON.stringify(\n        html\n      )}); document.close();`;\n    } catch (err2) {\n      // pass\n    }\n  }\n}\n\nexport function writeElementToWindow(\n  win: SameDomainWindowType,\n  el: HTMLElement\n) {\n  const tag = el.tagName.toLowerCase();\n\n  if (tag !== \"html\") {\n    throw new Error(`Expected element to be html, got ${tag}`);\n  }\n\n  const documentElement = win.document.documentElement;\n\n  for (const child of arrayFrom(documentElement.children)) {\n    documentElement.removeChild(child);\n  }\n\n  for (const child of arrayFrom(el.children)) {\n    documentElement.appendChild(child);\n  }\n}\n\nexport function setStyle(\n  el: HTMLElement,\n  styleText: string,\n  doc: Document = window.document\n) {\n  // $FlowFixMe\n  if (el.styleSheet) {\n    // $FlowFixMe\n    el.styleSheet.cssText = styleText;\n  } else {\n    el.appendChild(doc.createTextNode(styleText));\n  }\n}\n\nexport type ElementOptionsType = {|\n  style?: { [string]: string },\n  id?: string,\n  class?: ?$ReadOnlyArray<string>,\n  attributes?: { [string]: string },\n  styleSheet?: ?string,\n  html?: ?string,\n|};\n\nlet awaitFrameLoadPromises: WeakMap<\n  HTMLIFrameElement,\n  ZalgoPromise<HTMLIFrameElement>\n>;\n\nexport function awaitFrameLoad(\n  frame: HTMLIFrameElement\n): ZalgoPromise<HTMLIFrameElement> {\n  awaitFrameLoadPromises = awaitFrameLoadPromises || new WeakMap();\n\n  if (awaitFrameLoadPromises.has(frame)) {\n    const promise = awaitFrameLoadPromises.get(frame);\n    if (promise) {\n      return promise;\n    }\n  }\n\n  const promise = new ZalgoPromise((resolve, reject) => {\n    frame.addEventListener(\"load\", () => {\n      linkFrameWindow(frame);\n      resolve(frame);\n    });\n\n    frame.addEventListener(\"error\", (err: Event) => {\n      if (frame.contentWindow) {\n        resolve(frame);\n      } else {\n        reject(err);\n      }\n    });\n  });\n\n  awaitFrameLoadPromises.set(frame, promise);\n\n  return promise;\n}\n\nexport function awaitFrameWindow(\n  frame: HTMLIFrameElement\n): ZalgoPromise<CrossDomainWindowType> {\n  return awaitFrameLoad(frame).then((loadedFrame) => {\n    if (!loadedFrame.contentWindow) {\n      throw new Error(`Could not find window in iframe`);\n    }\n\n    return loadedFrame.contentWindow;\n  });\n}\n\nconst getDefaultCreateElementOptions = (): ElementOptionsType => {\n  // $FlowFixMe\n  return {};\n};\n\nexport function createElement(\n  tag: string = \"div\",\n  options: ElementOptionsType = getDefaultCreateElementOptions(),\n  container: ?HTMLElement\n): HTMLElement {\n  tag = tag.toLowerCase();\n  const element = document.createElement(tag);\n\n  if (options.style) {\n    extend(element.style, options.style);\n  }\n\n  if (options.class) {\n    element.className = options.class.join(\" \");\n  }\n\n  if (options.id) {\n    element.setAttribute(\"id\", options.id);\n  }\n\n  if (options.attributes) {\n    for (const key of Object.keys(options.attributes)) {\n      element.setAttribute(key, options.attributes[key]);\n    }\n  }\n\n  if (options.styleSheet) {\n    setStyle(element, options.styleSheet);\n  }\n\n  if (container) {\n    appendChild(container, element);\n  }\n\n  if (options.html) {\n    if (tag === \"iframe\") {\n      // $FlowFixMe\n      if (!container || !element.contentWindow) {\n        throw new Error(\n          `Iframe html can not be written unless container provided and iframe in DOM`\n        );\n      }\n\n      // $FlowFixMe\n      writeToWindow(element.contentWindow, options.html);\n    } else {\n      element.innerHTML = options.html;\n    }\n  }\n\n  return element;\n}\n\ntype StringMap = {|\n  [string]: string,\n|};\n\nexport type IframeElementOptionsType = {|\n  style?: StringMap,\n  class?: ?$ReadOnlyArray<string>,\n  attributes?: StringMap,\n  styleSheet?: ?string,\n  html?: ?string,\n  url?: ?string,\n|};\n\nconst getDefaultIframeOptions = (): IframeElementOptionsType => {\n  // $FlowFixMe\n  return {};\n};\n\nconst getDefaultStringMap = (): StringMap => {\n  // $FlowFixMe\n  return {};\n};\n\nexport function iframe(\n  options: IframeElementOptionsType = getDefaultIframeOptions(),\n  container: ?HTMLElement\n): HTMLIFrameElement {\n  const attributes = options.attributes || getDefaultStringMap();\n  const style = options.style || getDefaultStringMap();\n\n  // $FlowFixMe\n  const newAttributes = {\n    allowTransparency: \"true\",\n    ...attributes,\n  };\n\n  // $FlowFixMe\n  const newStyle = {\n    backgroundColor: \"transparent\",\n    border: \"none\",\n    ...style,\n  };\n\n  const frame = createElement(\"iframe\", {\n    attributes: newAttributes,\n    style: newStyle,\n    html: options.html,\n    class: options.class,\n  });\n\n  const isIE = window.navigator.userAgent.match(/MSIE|Edge/i);\n\n  if (!frame.hasAttribute(\"id\")) {\n    frame.setAttribute(\"id\", uniqueID());\n  }\n\n  // $FlowFixMe\n  awaitFrameLoad(frame);\n\n  if (container) {\n    const el = getElement(container);\n    el.appendChild(frame);\n  }\n\n  if (options.url || isIE) {\n    frame.setAttribute(\"src\", options.url || \"about:blank\");\n  }\n\n  // $FlowFixMe\n  return frame;\n}\n\nexport function addEventListener(\n  obj: HTMLElement,\n  event: string,\n  handler: (event: Event) => void\n): CancelableType {\n  obj.addEventListener(event, handler);\n  return {\n    cancel() {\n      obj.removeEventListener(event, handler);\n    },\n  };\n}\n\nexport function bindEvents(\n  element: HTMLElement,\n  eventNames: $ReadOnlyArray<string>,\n  handler: (event: Event) => void\n): CancelableType {\n  handler = once(handler);\n\n  for (const eventName of eventNames) {\n    element.addEventListener(eventName, handler);\n  }\n\n  return {\n    cancel: once(() => {\n      for (const eventName of eventNames) {\n        element.removeEventListener(eventName, handler);\n      }\n    }),\n  };\n}\n\nconst VENDOR_PREFIXES = [\"webkit\", \"moz\", \"ms\", \"o\"];\n\nexport function setVendorCSS(\n  element: HTMLElement,\n  name: string,\n  value: string\n) {\n  // $FlowFixMe\n  element.style[name] = value;\n\n  const capitalizedName = capitalizeFirstLetter(name);\n\n  for (const prefix of VENDOR_PREFIXES) {\n    // $FlowFixMe\n    element.style[`${prefix}${capitalizedName}`] = value;\n  }\n}\n\nconst ANIMATION_START_EVENTS = [\n  \"animationstart\",\n  \"webkitAnimationStart\",\n  \"oAnimationStart\",\n  \"MSAnimationStart\",\n];\nconst ANIMATION_END_EVENTS = [\n  \"animationend\",\n  \"webkitAnimationEnd\",\n  \"oAnimationEnd\",\n  \"MSAnimationEnd\",\n];\n\nexport function animate(\n  element: ElementRefType,\n  name: string,\n  clean: (Function) => void,\n  timeout: number = 1000\n): ZalgoPromise<void> {\n  return new ZalgoPromise((resolve, reject) => {\n    const el = getElement(element);\n\n    if (!el) {\n      return resolve();\n    }\n\n    let hasStarted = false;\n\n    // eslint-disable-next-line prefer-const\n    let startTimeout;\n    let endTimeout;\n    // eslint-disable-next-line prefer-const\n    let startEvent;\n    // eslint-disable-next-line prefer-const\n    let endEvent;\n\n    function cleanUp() {\n      clearTimeout(startTimeout);\n      clearTimeout(endTimeout);\n      startEvent.cancel();\n      endEvent.cancel();\n    }\n\n    startEvent = bindEvents(el, ANIMATION_START_EVENTS, (event) => {\n      // $FlowFixMe\n      if (event.target !== el || event.animationName !== name) {\n        return;\n      }\n\n      clearTimeout(startTimeout);\n\n      event.stopPropagation();\n\n      startEvent.cancel();\n      hasStarted = true;\n\n      endTimeout = setTimeout(() => {\n        cleanUp();\n        resolve();\n      }, timeout);\n    });\n\n    endEvent = bindEvents(el, ANIMATION_END_EVENTS, (event) => {\n      // $FlowFixMe\n      if (event.target !== el || event.animationName !== name) {\n        return;\n      }\n\n      cleanUp();\n\n      if (\n        // $FlowFixMe\n        typeof event.animationName === \"string\" &&\n        event.animationName !== name\n      ) {\n        return reject(\n          `Expected animation name to be ${name}, found ${event.animationName}`\n        );\n      }\n\n      return resolve();\n    });\n\n    setVendorCSS(el, \"animationName\", name);\n\n    startTimeout = setTimeout(() => {\n      if (!hasStarted) {\n        cleanUp();\n        return resolve();\n      }\n    }, 200);\n\n    if (clean) {\n      clean(cleanUp);\n    }\n  });\n}\n\nexport function makeElementVisible(element: HTMLElement) {\n  element.style.setProperty(\"visibility\", \"\");\n}\n\nexport function makeElementInvisible(element: HTMLElement) {\n  element.style.setProperty(\"visibility\", \"hidden\", \"important\");\n}\n\nexport function showElement(element: HTMLElement) {\n  element.style.setProperty(\"display\", \"\");\n}\n\nexport function hideElement(element: HTMLElement) {\n  element.style.setProperty(\"display\", \"none\", \"important\");\n}\n\nexport function destroyElement(element: HTMLElement) {\n  if (element && element.parentNode) {\n    element.parentNode.removeChild(element);\n  }\n}\n\nexport function showAndAnimate(\n  element: HTMLElement,\n  name: string,\n  clean: (Function) => void\n): ZalgoPromise<void> {\n  const animation = animate(element, name, clean);\n  showElement(element);\n  return animation;\n}\n\nexport function animateAndHide(\n  element: HTMLElement,\n  name: string,\n  clean: (Function) => void\n): ZalgoPromise<void> {\n  return animate(element, name, clean).then(() => {\n    hideElement(element);\n  });\n}\n\nexport function addClass(element: HTMLElement, name: string) {\n  element.classList.add(name);\n}\n\nexport function removeClass(element: HTMLElement, name: string) {\n  element.classList.remove(name);\n}\n\nexport function isElementClosed(el: HTMLElement): boolean {\n  if (\n    !el ||\n    !el.parentNode ||\n    !el.ownerDocument ||\n    !el.ownerDocument.documentElement ||\n    !el.ownerDocument.documentElement.contains(el)\n  ) {\n    return true;\n  }\n  return false;\n}\n\nexport function watchElementForClose(\n  element: HTMLElement,\n  handler: () => mixed\n): CancelableType {\n  handler = once(handler);\n\n  let cancelled = false;\n  const mutationObservers = [];\n  // eslint-disable-next-line prefer-const\n  let interval;\n  // eslint-disable-next-line prefer-const\n  let sacrificialFrame;\n  let sacrificialFrameWin;\n\n  const cancel = () => {\n    cancelled = true;\n    for (const observer of mutationObservers) {\n      observer.disconnect();\n    }\n    if (interval) {\n      interval.cancel();\n    }\n    if (sacrificialFrameWin) {\n      // eslint-disable-next-line no-use-before-define\n      sacrificialFrameWin.removeEventListener(\"unload\", elementClosed);\n    }\n    if (sacrificialFrame) {\n      destroyElement(sacrificialFrame);\n    }\n  };\n\n  const elementClosed = () => {\n    if (!cancelled) {\n      handler();\n      cancel();\n    }\n  };\n\n  if (isElementClosed(element)) {\n    elementClosed();\n    return { cancel };\n  }\n\n  // Strategy 1: Mutation observer\n\n  if (window.MutationObserver) {\n    let mutationElement = element.parentElement;\n    while (mutationElement) {\n      const mutationObserver = new window.MutationObserver(() => {\n        if (isElementClosed(element)) {\n          elementClosed();\n        }\n      });\n\n      mutationObserver.observe(mutationElement, { childList: true });\n      mutationObservers.push(mutationObserver);\n      mutationElement = mutationElement.parentElement;\n    }\n  }\n\n  // Strategy 2: Sacrificial iframe\n\n  sacrificialFrame = document.createElement(\"iframe\");\n  sacrificialFrame.setAttribute(\"name\", `__detect_close_${uniqueID()}__`);\n  sacrificialFrame.style.display = \"none\";\n  awaitFrameWindow(sacrificialFrame).then((frameWin) => {\n    sacrificialFrameWin = assertSameDomain(frameWin);\n    sacrificialFrameWin.addEventListener(\"unload\", elementClosed);\n  });\n  element.appendChild(sacrificialFrame);\n\n  // Strategy 3: Poller\n\n  const check = () => {\n    if (isElementClosed(element)) {\n      elementClosed();\n    }\n  };\n  interval = safeInterval(check, 1000);\n\n  return { cancel };\n}\n\nexport function fixScripts(el: HTMLElement, doc: Document = window.document) {\n  for (const script of querySelectorAll(\"script\", el)) {\n    const parentNode = script.parentNode;\n\n    if (!parentNode) {\n      continue;\n    }\n\n    const newScript = doc.createElement(\"script\");\n    newScript.text = script.textContent;\n    parentNode.replaceChild(newScript, script);\n  }\n}\n\ntype OnResizeOptions = {|\n  width?: boolean,\n  height?: boolean,\n  interval?: number,\n  win?: SameDomainWindowType,\n|};\n\nexport function onResize(\n  el: HTMLElement,\n  handler: ({| width: number, height: number |}) => void,\n  {\n    width = true,\n    height = true,\n    interval = 100,\n    win = window,\n  }: OnResizeOptions = {}\n): {| cancel: () => void |} {\n  let currentWidth = el.offsetWidth;\n  let currentHeight = el.offsetHeight;\n  let canceled = false;\n\n  handler({ width: currentWidth, height: currentHeight });\n\n  const check = () => {\n    if (canceled || !isElementVisible(el)) {\n      return;\n    }\n\n    const newWidth = el.offsetWidth;\n    const newHeight = el.offsetHeight;\n\n    if (\n      (width && newWidth !== currentWidth) ||\n      (height && newHeight !== currentHeight)\n    ) {\n      handler({ width: newWidth, height: newHeight });\n    }\n\n    currentWidth = newWidth;\n    currentHeight = newHeight;\n  };\n\n  let observer;\n  let timeout;\n\n  win.addEventListener(\"resize\", check);\n\n  if (typeof win.ResizeObserver !== \"undefined\") {\n    observer = new win.ResizeObserver(check);\n    observer.observe(el);\n    timeout = safeInterval(check, interval * 10);\n  } else if (typeof win.MutationObserver !== \"undefined\") {\n    observer = new win.MutationObserver(check);\n    observer.observe(el, {\n      attributes: true,\n      childList: true,\n      subtree: true,\n      characterData: false,\n    });\n    timeout = safeInterval(check, interval * 10);\n  } else {\n    timeout = safeInterval(check, interval);\n  }\n\n  return {\n    cancel: () => {\n      canceled = true;\n      observer.disconnect();\n      window.removeEventListener(\"resize\", check);\n      timeout.cancel();\n    },\n  };\n}\n\nexport function getResourceLoadTime(url: string): ?number {\n  const performance = getPerformance();\n\n  if (!performance) {\n    return;\n  }\n\n  // $FlowFixMe[method-unbinding]\n  if (typeof performance.getEntries !== \"function\") {\n    return;\n  }\n\n  const entries = performance.getEntries();\n\n  for (let i = 0; i < entries.length; i++) {\n    const entry = entries[i];\n\n    if (\n      entry &&\n      entry.name &&\n      entry.name.indexOf(url) === 0 &&\n      typeof entry.duration === \"number\"\n    ) {\n      return Math.floor(entry.duration);\n    }\n  }\n}\n\nexport function isShadowElement(element: Node): boolean {\n  while (element.parentNode) {\n    element = element.parentNode;\n  }\n\n  return element.toString() === \"[object ShadowRoot]\";\n}\n\nexport function getShadowRoot(element: Node): ?Node {\n  while (element.parentNode) {\n    element = element.parentNode;\n  }\n\n  if (isShadowElement(element)) {\n    return element;\n  }\n}\n\nexport function getShadowHost(element: Node): ?HTMLElement {\n  const shadowRoot = getShadowRoot(element);\n\n  // $FlowFixMe\n  if (shadowRoot && shadowRoot.host) {\n    // $FlowFixMe\n    return shadowRoot.host;\n  }\n}\n\nexport function insertShadowSlot(element: HTMLElement): HTMLElement {\n  const shadowHost = getShadowHost(element);\n\n  if (!shadowHost) {\n    throw new Error(`Element is not in shadow dom`);\n  }\n\n  const slotName = `shadow-slot-${uniqueID()}`;\n  const slot = document.createElement(\"slot\");\n  slot.setAttribute(\"name\", slotName);\n  element.appendChild(slot);\n\n  const slotProvider = document.createElement(\"div\");\n  slotProvider.setAttribute(\"slot\", slotName);\n  shadowHost.appendChild(slotProvider);\n\n  if (isShadowElement(shadowHost)) {\n    return insertShadowSlot(slotProvider);\n  }\n\n  return slotProvider;\n}\n\nexport function preventClickFocus(el: HTMLElement) {\n  const onFocus = (event: Event) => {\n    el.removeEventListener(\"focus\", onFocus);\n    event.preventDefault();\n    el.blur();\n    return false;\n  };\n\n  el.addEventListener(\"mousedown\", () => {\n    el.addEventListener(\"focus\", onFocus);\n    setTimeout(() => {\n      el.removeEventListener(\"focus\", onFocus);\n    }, 1);\n  });\n}\n\nexport function getStackTrace(): string {\n  try {\n    throw new Error(\"_\");\n  } catch (err) {\n    return err.stack || \"\";\n  }\n}\n\nfunction inferCurrentScript(): ?HTMLScriptElement {\n  try {\n    const stack = getStackTrace();\n    const stackDetails = /.*at [^(]*\\((.*):(.+):(.+)\\)$/gi.exec(stack);\n    const scriptLocation = stackDetails && stackDetails[1];\n\n    if (!scriptLocation) {\n      return;\n    }\n\n    // $FlowFixMe[method-unbinding]\n    for (const script of Array.prototype.slice\n      .call(document.getElementsByTagName(\"script\"))\n      .reverse()) {\n      if (script.src && script.src === scriptLocation) {\n        return script;\n      }\n    }\n  } catch (err) {\n    // pass\n  }\n}\n\nlet currentScript =\n  // eslint-disable-next-line compat/compat\n  typeof document !== \"undefined\" ? document.currentScript : null;\n\ntype GetCurrentScript = () => HTMLScriptElement;\n\nexport const getCurrentScript: GetCurrentScript = memoize(() => {\n  if (currentScript) {\n    return currentScript;\n  }\n\n  currentScript = inferCurrentScript();\n\n  if (currentScript) {\n    return currentScript;\n  }\n\n  throw new Error(\"Can not determine current script\");\n});\n\nconst currentUID = uniqueID();\n\ntype GetCurrentScriptUID = () => string;\n\nexport const getCurrentScriptUID: GetCurrentScriptUID = memoize(() => {\n  let script;\n\n  try {\n    script = getCurrentScript();\n  } catch (err) {\n    return currentUID;\n  }\n\n  let uid = script.getAttribute(ATTRIBUTES.UID);\n\n  if (uid && typeof uid === \"string\") {\n    return uid;\n  }\n\n  uid = script.getAttribute(`${ATTRIBUTES.UID}-auto`);\n\n  if (uid && typeof uid === \"string\") {\n    return uid;\n  }\n\n  if (script.src) {\n    const { src, dataset } = script;\n    const stringToHash = JSON.stringify({ src, dataset });\n    const hashedString = strHashStr(stringToHash);\n    const hashResult = hashedString.slice(\n      hashedString.length - UID_HASH_LENGTH\n    );\n\n    uid = `uid_${hashResult}`;\n  } else {\n    uid = uniqueID();\n  }\n\n  script.setAttribute(`${ATTRIBUTES.UID}-auto`, uid);\n\n  return uid;\n});\n\ntype SubmitFormOptions = {|\n  url: string,\n  target: string,\n  body?: {| [string]: string | boolean |},\n  method?: string,\n|};\n\nexport function submitForm({\n  url,\n  target,\n  body,\n  method = \"post\",\n}: SubmitFormOptions) {\n  const form = document.createElement(\"form\");\n  form.setAttribute(\"target\", target);\n  form.setAttribute(\"method\", method);\n  form.setAttribute(\"action\", url);\n  form.style.display = \"none\";\n\n  if (body) {\n    for (const key of Object.keys(body)) {\n      const input = document.createElement(\"input\");\n      input.setAttribute(\"name\", key);\n      input.setAttribute(\"value\", body[key]?.toString());\n      form.appendChild(input);\n    }\n  }\n\n  getBody().appendChild(form);\n  form.submit();\n  getBody().removeChild(form);\n}\n","/* @flow */\n\nimport { uniqueID, getGlobal, inlineMemoize } from \"./util\";\nimport { isLocalStorageEnabled } from \"./dom\";\n\ntype Getter<T> = <T>(handler: (Object) => T) => T;\n\nexport type Storage = {|\n  getState: Getter<*>,\n  getID: () => string,\n  isStateFresh: () => boolean,\n  getSessionState: Getter<*>,\n  getSessionID: () => string,\n|};\n\nconst DEFAULT_SESSION_STORAGE = 20 * 60 * 1000;\n\nexport function getStorage({\n  name,\n  lifetime = DEFAULT_SESSION_STORAGE,\n}: {|\n  name: string,\n  lifetime?: number,\n|}): Storage {\n  return inlineMemoize(\n    getStorage,\n    () => {\n      const STORAGE_KEY = `__${name}_storage__`;\n      const newStateID = uniqueID();\n\n      let accessedStorage;\n\n      function getState<T>(handler: (storage: Object) => T): T {\n        const localStorageEnabled = isLocalStorageEnabled();\n        let storage;\n\n        if (accessedStorage) {\n          storage = accessedStorage;\n        }\n\n        if (!storage && localStorageEnabled) {\n          const rawStorage = window.localStorage.getItem(STORAGE_KEY);\n\n          if (rawStorage) {\n            storage = JSON.parse(rawStorage);\n          }\n        }\n\n        if (!storage) {\n          storage = getGlobal()[STORAGE_KEY];\n        }\n\n        if (!storage) {\n          storage = {\n            id: newStateID,\n          };\n        }\n\n        if (!storage.id) {\n          storage.id = newStateID;\n        }\n\n        accessedStorage = storage;\n\n        const result = handler(storage);\n\n        if (localStorageEnabled) {\n          window.localStorage.setItem(STORAGE_KEY, JSON.stringify(storage));\n        } else {\n          getGlobal()[STORAGE_KEY] = storage;\n        }\n\n        accessedStorage = null;\n\n        return result;\n      }\n\n      function getID(): string {\n        return getState((storage) => storage.id);\n      }\n\n      function isStateFresh(): boolean {\n        return getID() === newStateID;\n      }\n\n      function getSession<T>(handler: (state: Object) => T): T {\n        return getState((storage) => {\n          let session = storage.__session__;\n          const now = Date.now();\n\n          if (session && now - session.created > lifetime) {\n            session = null;\n          }\n\n          if (!session) {\n            session = {\n              guid: uniqueID(),\n              created: now,\n            };\n          }\n\n          storage.__session__ = session;\n\n          return handler(session);\n        });\n      }\n\n      function getSessionState<T>(handler: (state: Object) => T): T {\n        return getSession((session) => {\n          session.state = session.state || {};\n          return handler(session.state);\n        });\n      }\n\n      function getSessionID(): string {\n        return getSession((session) => session.guid);\n      }\n\n      return {\n        getState,\n        getID,\n        isStateFresh,\n        getSessionState,\n        getSessionID,\n      };\n    },\n    [{ name, lifetime }]\n  );\n}\n","/* @flow */\n\nimport { noop } from \"./util\";\nimport { getStorage } from \"./storage\";\n\nfunction getBelterExperimentStorage(): Object {\n  return getStorage({ name: \"belter_experiment\" });\n}\n\nfunction isEventUnique(name: string): boolean {\n  return getBelterExperimentStorage().getSessionState((state) => {\n    state.loggedBeacons = state.loggedBeacons || [];\n\n    if (state.loggedBeacons.indexOf(name) === -1) {\n      state.loggedBeacons.push(name);\n      return true;\n    }\n\n    return false;\n  });\n}\n\ntype Payload = {\n  [string]: ?(string | boolean),\n};\n\nexport type Experiment = {|\n  isEnabled: () => boolean,\n  isDisabled: () => boolean,\n  getTreatment: () => string,\n  log: (string, payload?: Payload) => Experiment,\n  logStart: (payload?: Payload) => Experiment,\n  logComplete: (payload?: Payload) => Experiment,\n|};\n\nfunction getRandomInteger(range: number): number {\n  return Math.floor(Math.random() * range);\n}\n\nfunction getThrottlePercentile(name: string): number {\n  return getBelterExperimentStorage().getState((state) => {\n    state.throttlePercentiles = state.throttlePercentiles || {};\n    state.throttlePercentiles[name] =\n      state.throttlePercentiles[name] || getRandomInteger(100);\n    return state.throttlePercentiles[name];\n  });\n}\n\nconst THROTTLE_GROUP = {\n  TEST: \"test\",\n  CONTROL: \"control\",\n  THROTTLE: \"throttle\",\n};\n\ntype ExperimentOptions = {|\n  name: string,\n  sample?: number,\n  logTreatment?: ({|\n    name: string,\n    treatment: string,\n    payload: Payload,\n    throttle: number,\n  |}) => void,\n  logCheckpoint?: ({|\n    name: string,\n    treatment: string,\n    checkpoint: string,\n    payload: Payload,\n    throttle: number,\n  |}) => void,\n  sticky?: boolean,\n|};\n\nexport function experiment({\n  name,\n  sample = 50,\n  logTreatment = noop,\n  logCheckpoint = noop,\n  sticky = true,\n}: ExperimentOptions): Experiment {\n  const throttle = sticky ? getThrottlePercentile(name) : getRandomInteger(100);\n\n  let group;\n\n  if (throttle < sample && !__TEST__) {\n    group = THROTTLE_GROUP.TEST;\n  } else if (sample >= 50 || (sample <= throttle && throttle < sample * 2)) {\n    group = THROTTLE_GROUP.CONTROL;\n  } else {\n    group = THROTTLE_GROUP.THROTTLE;\n  }\n\n  const treatment = `${name}_${group}`;\n\n  let started = false;\n  let forced = false;\n\n  try {\n    if (window.localStorage && window.localStorage.getItem(name)) {\n      forced = true;\n    }\n  } catch (err) {\n    // pass\n  }\n\n  const exp = {\n    isEnabled(): boolean {\n      return group === THROTTLE_GROUP.TEST || forced;\n    },\n\n    isDisabled(): boolean {\n      return group !== THROTTLE_GROUP.TEST && !forced;\n    },\n\n    getTreatment(): string {\n      return treatment;\n    },\n\n    log(checkpoint: string, payload?: Payload = {}): Experiment {\n      if (!started) {\n        return exp;\n      }\n\n      if (isEventUnique(`${treatment}_${JSON.stringify(payload)}`)) {\n        logTreatment({ name, treatment, payload, throttle });\n      }\n\n      if (\n        isEventUnique(`${treatment}_${checkpoint}_${JSON.stringify(payload)}`)\n      ) {\n        logCheckpoint({ name, treatment, checkpoint, payload, throttle });\n      }\n\n      return exp;\n    },\n\n    logStart(payload?: Payload = {}): Experiment {\n      started = true;\n      return exp.log(`start`, payload);\n    },\n\n    logComplete(payload?: Payload = {}): Experiment {\n      return exp.log(`complete`, payload);\n    },\n  };\n\n  return exp;\n}\n","/* @flow */\n\nimport { getGlobal } from \"./util\";\n\nexport function getGlobalNameSpace<T: Object>({\n  name,\n  version = \"latest\",\n}: {|\n  name: string,\n  version?: string,\n|}): {| get: (string, defValue?: T) => T |} {\n  const global = getGlobal();\n  const globalKey = `__${name}__${version}_global__`;\n\n  const namespace = (global[globalKey] = global[globalKey] || {});\n\n  return {\n    get: (key: string, defValue?: T): T => {\n      // $FlowFixMe\n      defValue = defValue || {};\n      const item = (namespace[key] = namespace[key] || defValue);\n      return item;\n    },\n  };\n}\n","/* @flow */\n\nimport { ZalgoPromise } from \"@krakenjs/zalgo-promise/src\";\nimport { type SameDomainWindowType } from \"@krakenjs/cross-domain-utils/src\";\n\ntype RequestOptionsType = {|\n  url: string,\n  method?: string,\n  headers?: { [key: string]: string },\n  json?: $ReadOnlyArray<mixed> | Object,\n  data?: { [key: string]: string },\n  body?: string,\n  win?: SameDomainWindowType,\n  timeout?: number,\n|};\n\ntype ResponseType = {|\n  status: number,\n  headers: { [string]: string },\n  body: Object,\n|};\n\nconst HEADERS = {\n  CONTENT_TYPE: \"content-type\",\n  ACCEPT: \"accept\",\n};\n\nconst headerBuilders = [];\n\nfunction parseHeaders(rawHeaders: string = \"\"): { [string]: string } {\n  const result = {};\n  for (const line of rawHeaders.trim().split(\"\\n\")) {\n    const [key, ...values] = line.split(\":\");\n    result[key.toLowerCase()] = values.join(\":\").trim();\n  }\n  return result;\n}\n\nexport function request({\n  url,\n  method = \"get\",\n  headers = {},\n  json,\n  data,\n  body,\n  win = window,\n  timeout = 0,\n}: RequestOptionsType): ZalgoPromise<ResponseType> {\n  return new ZalgoPromise((resolve, reject) => {\n    if ((json && data) || (json && body) || (data && json)) {\n      throw new Error(\n        `Only options.json or options.data or options.body should be passed`\n      );\n    }\n\n    const normalizedHeaders = {};\n\n    for (const key of Object.keys(headers)) {\n      normalizedHeaders[key.toLowerCase()] = headers[key];\n    }\n\n    if (json) {\n      normalizedHeaders[HEADERS.CONTENT_TYPE] =\n        normalizedHeaders[HEADERS.CONTENT_TYPE] || \"application/json\";\n    } else if (data || body) {\n      normalizedHeaders[HEADERS.CONTENT_TYPE] =\n        normalizedHeaders[HEADERS.CONTENT_TYPE] ||\n        \"application/x-www-form-urlencoded; charset=utf-8\";\n    }\n\n    normalizedHeaders[HEADERS.ACCEPT] =\n      normalizedHeaders[HEADERS.ACCEPT] || \"application/json\";\n\n    for (const headerBuilder of headerBuilders) {\n      const builtHeaders = headerBuilder();\n\n      for (const key of Object.keys(builtHeaders)) {\n        normalizedHeaders[key.toLowerCase()] = builtHeaders[key];\n      }\n    }\n\n    const xhr = new win.XMLHttpRequest();\n\n    xhr.addEventListener(\n      \"load\",\n      function xhrLoad(): void {\n        const responseHeaders = parseHeaders(this.getAllResponseHeaders());\n\n        if (!this.status) {\n          return reject(\n            new Error(\n              `Request to ${method.toLowerCase()} ${url} failed: no response status code.`\n            )\n          );\n        }\n\n        const contentType = responseHeaders[\"content-type\"];\n        const isJSON =\n          contentType &&\n          (contentType.indexOf(\"application/json\") === 0 ||\n            contentType.indexOf(\"text/json\") === 0);\n        let responseBody = this.responseText;\n\n        try {\n          responseBody = JSON.parse(responseBody);\n        } catch (err) {\n          if (isJSON) {\n            return reject(new Error(`Invalid json: ${this.responseText}.`));\n          }\n        }\n\n        const res = {\n          status: this.status,\n          headers: responseHeaders,\n          body: responseBody,\n        };\n\n        return resolve(res);\n      },\n      false\n    );\n\n    xhr.addEventListener(\n      \"error\",\n      (evt) => {\n        reject(\n          new Error(\n            `Request to ${method.toLowerCase()} ${url} failed: ${evt.toString()}.`\n          )\n        );\n      },\n      false\n    );\n\n    xhr.open(method, url, true);\n\n    for (const key in normalizedHeaders) {\n      if (normalizedHeaders.hasOwnProperty(key)) {\n        xhr.setRequestHeader(key, normalizedHeaders[key]);\n      }\n    }\n\n    if (json) {\n      body = JSON.stringify(json);\n    } else if (data) {\n      body = Object.keys(data)\n        .map((key) => {\n          return `${encodeURIComponent(key)}=${\n            data ? encodeURIComponent(data[key]) : \"\"\n          }`;\n        })\n        .join(\"&\");\n    }\n\n    xhr.timeout = timeout;\n    xhr.ontimeout = function xhrTimeout() {\n      reject(\n        new Error(`Request to ${method.toLowerCase()} ${url} has timed out`)\n      );\n    };\n\n    xhr.send(body);\n  });\n}\n\nexport function addHeaderBuilder(method: () => { [string]: string }) {\n  headerBuilders.push(method);\n}\n","/* @flow */\n\n// export something to force webpack to see this as an ES module\nexport const TYPES = true;\n\ndeclare var __TEST__: boolean;\n\nexport type JSONPrimitive = string | boolean | number;\nexport type JSONObject =\n  | { [string]: JSONPrimitive | JSONObject }\n  | $ReadOnlyArray<JSONPrimitive | JSONObject>;\nexport type JSONType = JSONObject | JSONPrimitive;\n\nexport type CancelableType = {|\n  cancel: () => void,\n|};\n","/* @flow */\n\nimport { memoize, promisify } from \"./util\";\n\nexport function memoized(target: Object, name: string, descriptor: Object) {\n  descriptor.value = memoize(descriptor.value, { name, thisNamespace: true });\n}\n\nexport function promise(target: Object, name: string, descriptor: Object) {\n  descriptor.value = promisify(descriptor.value, { name });\n}\n","/* @flow */\n\nexport function isPerc(str: string): boolean {\n  return typeof str === \"string\" && /^[0-9]+%$/.test(str);\n}\n\nexport function isPx(str: string): boolean {\n  return typeof str === \"string\" && /^[0-9]+px$/.test(str);\n}\n\nexport function toNum(val: string | number): number {\n  if (typeof val === \"number\") {\n    return val;\n  }\n\n  const match = val.match(/^([0-9]+)(px|%)$/);\n\n  if (!match) {\n    throw new Error(`Could not match css value from ${val}`);\n  }\n\n  return parseInt(match[1], 10);\n}\n\nexport function toPx(val: number | string): string {\n  return `${toNum(val)}px`;\n}\n\nexport function toCSS(val: number | string): string {\n  if (typeof val === \"number\") {\n    return toPx(val);\n  }\n\n  return isPerc(val) ? val : toPx(val);\n}\n\nexport function percOf(num: number, perc: string): number {\n  return parseInt((num * toNum(perc)) / 100, 10);\n}\n\nexport function normalizeDimension(dim: string | number, max: number): number {\n  if (typeof dim === \"number\") {\n    return dim;\n  } else if (isPerc(dim)) {\n    return percOf(max, dim);\n  } else if (isPx(dim)) {\n    return toNum(dim);\n  } else {\n    throw new Error(`Can not normalize dimension: ${dim}`);\n  }\n}\n","/* @flow */\n\nimport { ZalgoPromise } from \"@krakenjs/zalgo-promise/src\";\n\nimport { noop, tryCatch, removeFromArray } from \"./util\";\n\ntype Prom<X> = Promise<X> | ZalgoPromise<X>; // eslint-disable-line no-restricted-globals, promise/no-native\n\n// eslint-disable-next-line no-undef\ntype Handler = <T, A: $ReadOnlyArray<mixed>>(\n  name: string,\n  // eslint-disable-next-line no-undef\n  fn?: (...args: A) => T\n  // eslint-disable-next-line no-undef\n) => (...args: A) => T;\ntype Wrapper<T> = ({|\n  expect: Handler,\n  avoid: Handler,\n  expectError: Handler,\n  error: Handler,\n  wait: () => Prom<void>,\n|}) => Prom<T> | void;\n\nexport function wrapPromise<T>(\n  method: Wrapper<T>,\n  { timeout = 5000 }: {| timeout?: number |} = {}\n): ZalgoPromise<void> {\n  const expected: Array<{| name: string, handler: Handler |}> = [];\n  const promises: Array<{| name: string, promise: ZalgoPromise<*> |}> = [];\n\n  return new ZalgoPromise((resolve, reject) => {\n    const timer = setTimeout(() => {\n      if (expected.length) {\n        reject(\n          new Error(`Expected ${expected[0].name} to be called in ${timeout}ms`)\n        );\n      }\n\n      if (promises.length) {\n        reject(\n          new Error(\n            `Expected ${promises[0].name} promise to complete in ${timeout}ms`\n          )\n        );\n      }\n    }, timeout);\n\n    // $FlowFixMe[escaped-generic]\n    const expect: Handler = (name, handler = noop) => {\n      const exp = { name, handler };\n      // $FlowFixMe\n      expected.push(exp);\n\n      // $FlowFixMe\n      return function expectWrapper(...args): * {\n        removeFromArray(expected, exp);\n\n        // $FlowFixMe\n        const { result, error } = tryCatch(() => handler.call(this, ...args));\n\n        if (error) {\n          promises.push({ name, promise: ZalgoPromise.asyncReject(error) });\n          throw error;\n        }\n\n        // $FlowFixMe[escaped-generic]\n        promises.push({ name, promise: ZalgoPromise.resolve(result) });\n\n        // $FlowFixMe[escaped-generic]\n        return result;\n      };\n    };\n\n    // $FlowFixMe[escaped-generic]\n    const avoid: Handler = (name: string, fn = noop) => {\n      // $FlowFixMe\n      return function avoidWrapper(...args): * {\n        promises.push({\n          name,\n          promise: ZalgoPromise.asyncReject(\n            new Error(`Expected ${name} to not be called`)\n          ),\n        });\n        // $FlowFixMe\n        return fn.call(this, ...args);\n      };\n    };\n\n    // $FlowFixMe[escaped-generic]\n    const expectError: Handler = (name, handler = noop) => {\n      const exp = { name, handler };\n      // $FlowFixMe\n      expected.push(exp);\n\n      // $FlowFixMe\n      return function expectErrorWrapper(...args): * {\n        removeFromArray(expected, exp);\n\n        // $FlowFixMe\n        const { result, error } = tryCatch(() => handler.call(this, ...args));\n\n        if (error) {\n          throw error;\n        }\n\n        promises.push({\n          name,\n          // $FlowFixMe[escaped-generic]\n          promise: ZalgoPromise.resolve(result).then(() => {\n            throw new Error(`Expected ${name} to throw an error`);\n          }, noop),\n        });\n\n        // $FlowFixMe[escaped-generic]\n        return result;\n      };\n    };\n\n    const wait = () => {\n      return ZalgoPromise.try(() => {\n        if (promises.length) {\n          const prom = promises[0];\n          return prom.promise\n            .finally(() => {\n              removeFromArray(promises, prom);\n            })\n            .then(wait);\n        }\n      }).then(() => {\n        if (expected.length) {\n          return ZalgoPromise.delay(10).then(wait);\n        }\n      });\n    };\n\n    promises.push({\n      name: \"wrapPromise handler\",\n      promise: ZalgoPromise.try(() =>\n        method({\n          expect,\n          avoid,\n          expectError,\n          error: avoid,\n          wait: () => ZalgoPromise.resolve(),\n        })\n      ),\n    });\n\n    wait()\n      .finally(() => {\n        clearTimeout(timer);\n      })\n      .then(resolve, reject);\n  });\n}\n"],"names":["root","factory","exports","module","define","amd","self","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","sfvcScreens","textSizeHeights","textSizeHeightsNoTabs","zoomHeight","maybeSafari","getUserAgent","window","navigator","mockUserAgent","userAgent","TABLET_PATTERN","isDevice","match","isTablet","test","isWebView","isStandAlone","standalone","matchMedia","matches","isFacebookWebView","ua","isFirefox","isFirefoxIOS","isEdgeIOS","isOperaMini","isAndroid","isIos","isIOS14","isGoogleSearchApp","isQQBrowser","isIosWebview","isSFVC","height","innerHeight","scale","Math","round","screen","width","innerWidth","computedHeight","device","outerHeight","indexOf","isSFVCorSafari","sfvc","possibleSafariSizes","isAndroidWebview","isIE","document","documentMode","Boolean","isIECompHeader","mHttp","querySelector","mContent","isElectron","process","versions","electron","isIEIntranet","status","err","isMacOsCna","supportsPopups","isChrome","isSafari","isApplePaySupported","ApplePaySession","supportsVersion","canMakePayments","e","isCrossSiteTrackingEnabled","expectedCookieKey","cookie","_setPrototypeOf","p","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","_extends","assign","target","i","arguments","length","source","apply","isPromise","item","Promise","Window","toString","name","then","flushPromise","dispatchedErrors","possiblyUnhandledPromiseHandlers","activeCount","flushActive","promise","resolve","startActive","endActive","ZalgoPromise","handler","_this","resolved","rejected","errorHandled","error","handlers","dispatching","stack","result","isAsync","res","reject","_proto","Error","dispatch","_this2","setTimeout","push","j","dispatchPossiblyUnhandledError","asyncReject","chain","firstPromise","secondPromise","_handlers$i","onSuccess","onError","promiseResult","catch","undefined","finally","onFinally","try","timeout","time","_this3","clearTimeout","toPromise","TypeError","lazy","all","promises","count","results","slice","prom","hash","awaitPromises","_loop","map","items","method","onPossiblyUnhandledException","cancel","splice","context","args","delay","flush","Zalgo","awaitActive","PROTOCOL","MOCK","FILE","ABOUT","IE_WIN_ACCESS_ERROR","getActualProtocol","win","location","protocol","getProtocol","mockDomain","split","isAboutProtocol","canReadFromWindow","getActualDomain","parent","getParent","host","getDomain","domain","isSameDomain","desc","getOwnPropertyDescriptor","isMockProtocol","isActuallySameDomain","iframeWindows","iframeFrames","isWindowClosed","allowMock","closed","message","mockclosed","top","iframeIndex","collection","safeIndexOf","frame","contentWindow","parentNode","doc","ownerDocument","documentElement","contains","isFrameWindowClosed","isWindow","__cross_domain_utils_window_check__","objectIDs","CrossDomainSafeWeakMap","weakmap","keys","values","random","WeakMap","freeze","testWeakMap","testKey","testValue","set","hasNativeWeakMap","_cleanupClosedWindows","delete","isSafeToReadWrite","entry","writable","index","has","getOrSet","getter","_getPrototypeOf","getPrototypeOf","_construct","Parent","Class","Reflect","construct","sham","Proxy","Date","isNativeReflectConstruct","a","instance","Function","bind","_wrapNativeSuper","_cache","Map","Wrapper","configurable","isElement","element","passed","Element","nodeType","style","_","getFunctionName","fn","__name__","displayName","setFunctionName","base64encode","str","btoa","encodeURIComponent","replace","m","p1","String","fromCharCode","parseInt","Buffer","from","base64decode","atob","decodeURIComponent","Array","c","charCodeAt","join","uniqueID","charAt","floor","chars","toISOString","toLowerCase","getGlobal","global","__GLOBAL__","getObjectID","uid","serializeArgs","JSON","stringify","subkey","val","getEmptyObject","getDefaultMemoizeOptions","memoizeGlobalIndex","memoizeGlobalIndexValidFrom","memoize","options","simpleCache","thisCache","_options$thisNamespac","thisNamespace","cacheTime","memoizeIndex","memoizedFunction","_len","_key","cache","cacheKey","_unused","cacheResult","now","reset","promiseIdentity","memoizePromise","memoizedPromiseFunction","_arguments","_len2","_key2","clear","getDefaultPromisifyOptions","promisify","promisifiedFunction","inlineMemoize","logic","__inline_memoize_cache__","noop","once","called","hashStr","pow","sqrt","strHashStr","total","abs","pattern","regmatch","awaitKey","stringifyError","level","newErr","stringifyErrorMessage","defaultMessage","domainMatches","hostname","patchMethod","original","_arguments2","callOriginal","extend","memoizedValues","perc","pixels","percentage","min","max","roundUp","num","nearest","remainder","regexMap","regexp","svgToBase64","svg","objFilter","filter","identity","regexTokenize","text","token","promiseDebounce","localPromise","safeInterval","loop","isInteger","isFloat","serializePrimitive","deserializePrimitive","parseFloat","dotify","prefix","newobj","isArray","every","undotify","keyResult","parts","part","isLast","isIndex","eventEmitter","triggered","emitter","on","eventName","handlerList","cancelled","listener","trigger","_len3","_key3","_i2","triggerOnce","_len4","_key4","concat","camelToDasherize","string","g","dasherizeToCamel","toUpperCase","capitalizeFirstLetter","path","def","pathParts","safeTimeout","interval","defineLazyProp","arrayFrom","isObject","isObjectObject","isPlainObject","replaceObject","replacer","fullKey","_loop2","itemKey","child","_loop3","copyProp","descriptor","regex","start","RegExp","groups","end","regexAll","isDefined","cycle","debounce","_arguments3","isRegex","weakMapMemoize","arg","_this4","weakMapMemoizePromise","_this5","cleanup","cleanErr","tasks","cleaned","cleaner","register","task","shift","tryCatch","removeFromArray","arr","assertExists","thing","unique","_i4","constHas","constant","dedupeErrors","seenErrors","seenStringifiedErrors","stringifiedError","ExtendableError","_Error","_this6","captureStackTrace","ReferenceError","_assertThisInitialized","KEY_CODES","ENTER","SPACE","ATTRIBUTES","UID","UID_HASH_LENGTH","getBody","body","isDocumentReady","readyState","isDocumentInteractive","urlEncode","waitForWindowReady","addEventListener","waitForDocumentReady","setInterval","clearInterval","waitForDocumentBody","parseQuery","queryString","params","_queryString$split2","pair","getQueryParam","search","urlWillRedirectPage","url","href","formatQuery","extendQuery","originalQuery","props","extendUrl","originalUrl","originalHash","query","_url$split","_originalUrl$split","hashString","redirect","hasMetaViewPort","meta","isElementVisible","el","offsetWidth","offsetHeight","getClientRects","getPerformance","performance","timing","connectEnd","navigationStart","enablePerformance","getPageRenderTime","domInteractive","htmlEncode","html","isBrowser","querySelectorAll","selector","onClick","passive","event","keyCode","getScript","_ref","_ref$host","_ref$reverse","reverse","scripts","getElementsByTagName","script","src","isLocalStorageEnabled","localStorage","setItem","getItem","removeItem","getBrowserLocales","nav","locales","languages","language","userLanguage","locale","_locale$split","country","lang","appendChild","container","getElementSafe","id","getElement","elementReady","awaitFrameLoadPromises","PopupOpenError","_ExtendableError","popup","_options$closeOnUnloa","closeOnUnload","_options$name","left","outerWidth","screenX","screenY","toolbar","menubar","resizable","scrollbars","open","close","writeToWindow","write","err2","writeElementToWindow","tag","tagName","_i6","_arrayFrom2","children","removeChild","_i8","_arrayFrom4","setStyle","styleText","styleSheet","cssText","createTextNode","awaitFrameLoad","cleanIframes","linkFrameWindow","awaitFrameWindow","loadedFrame","getDefaultCreateElementOptions","createElement","class","className","setAttribute","attributes","_i10","_Object$keys2","innerHTML","getDefaultIframeOptions","getDefaultStringMap","iframe","allowTransparency","backgroundColor","border","hasAttribute","removeEventListener","bindEvents","eventNames","_i12","_i14","VENDOR_PREFIXES","setVendorCSS","capitalizedName","_i16","ANIMATION_START_EVENTS","ANIMATION_END_EVENTS","animate","clean","startTimeout","endTimeout","startEvent","endEvent","hasStarted","cleanUp","animationName","stopPropagation","makeElementVisible","setProperty","makeElementInvisible","showElement","hideElement","destroyElement","showAndAnimate","animation","animateAndHide","addClass","classList","add","removeClass","remove","isElementClosed","watchElementForClose","sacrificialFrame","sacrificialFrameWin","mutationObservers","_i18","disconnect","elementClosed","MutationObserver","mutationElement","parentElement","mutationObserver","observe","childList","display","frameWin","assertSameDomain","fixScripts","_i20","_querySelectorAll2","newScript","textContent","replaceChild","onResize","_temp","_ref2","_ref2$width","_ref2$height","_ref2$interval","_ref2$win","currentWidth","currentHeight","canceled","observer","check","newWidth","newHeight","ResizeObserver","subtree","characterData","getResourceLoadTime","getEntries","entries","duration","isShadowElement","getShadowRoot","getShadowHost","shadowRoot","insertShadowSlot","shadowHost","slotName","slot","slotProvider","preventClickFocus","onFocus","preventDefault","blur","getStackTrace","currentScript","getCurrentScript","stackDetails","exec","scriptLocation","_i22","_Array$prototype$slic2","inferCurrentScript","currentUID","getCurrentScriptUID","getAttribute","hashedString","dataset","submitForm","_ref3","_ref3$method","form","_i24","_Object$keys4","_body$key","input","submit","DEFAULT_SESSION_STORAGE","getStorage","_ref$lifetime","lifetime","accessedStorage","STORAGE_KEY","newStateID","getState","storage","localStorageEnabled","rawStorage","parse","getID","getSession","session","__session__","created","guid","isStateFresh","getSessionState","state","getSessionID","getBelterExperimentStorage","isEventUnique","loggedBeacons","getRandomInteger","range","THROTTLE_GROUP","TEST","CONTROL","THROTTLE","experiment","group","_ref$sample","sample","_ref$logTreatment","logTreatment","_ref$logCheckpoint","logCheckpoint","_ref$sticky","sticky","throttle","throttlePercentiles","getThrottlePercentile","treatment","started","forced","exp","isEnabled","isDisabled","getTreatment","log","checkpoint","payload","logStart","logComplete","getGlobalNameSpace","_ref$version","version","globalKey","namespace","defValue","HEADERS","CONTENT_TYPE","ACCEPT","headerBuilders","request","_ref$method","_ref$headers","headers","json","data","_ref$win","_ref$timeout","normalizedHeaders","builtHeaders","headerBuilder","xhr","XMLHttpRequest","responseHeaders","rawHeaders","_rawHeaders$trim$spli2","trim","_line$split","parseHeaders","getAllResponseHeaders","contentType","isJSON","responseBody","responseText","evt","setRequestHeader","ontimeout","send","addHeaderBuilder","TYPES","memoized","isPerc","isPx","toNum","toPx","toCSS","percOf","normalizeDimension","dim","wrapPromise","expected","timer","expect","_tryCatch","_handler","avoid","_fn","expectError","_tryCatch2","_handler2","wait"],"sourceRoot":""}